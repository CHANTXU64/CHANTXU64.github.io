/** copyright info
 * [GF_logistics]{@link https://github.com/CHANTXU64/Girls-Frontline}
 *
 * @namespace GF_logistics
 * @version 1.3.0-alpha
 * @author ChantXu64 [chantxu@outlook.com]
 * @copyright ChantXu64
 * @license MIT
 */
window.ResultsPlan_JS=!0;var jt=(e(Yt,null,[{key:"clear",value:function(){this._lastResultsPlan=[],this._lastSortBy="Ranking"}},{key:"getLastResultsPlan",value:function(){return this._lastResultsPlan}},{key:"getLastSortBy",value:function(){return this._lastSortBy}},{key:"print",value:function(e,t){var a=0<arguments.length&&void 0!==e?e:this._lastResultsPlan,n=1<arguments.length&&void 0!==t?t:this._lastSortBy;if(document.getElementById("start_ranking_html").style.display="none",0===a.length)document.getElementById("Plan_Table").innerHTML=f.JS.NoPlan,this.clear();else{var i=0,r=document.getElementById("result_plan_table");null!==r&&(i=r.scrollLeft);var o=this.sortResultPlan(a,n);document.getElementById("Plan_Table").innerHTML=this._getPrintHtml(o),0!=i&&(document.getElementById("result_plan_table").scrollLeft=i),this._lastResultsPlan=o,this._lastSortBy=n}}},{key:"sortResultPlan",value:function(e,t){var a=e.slice();switch(t){case"Ranking":v(a,0);break;case"Manp":h(a,5);break;case"Ammu":h(a,6);break;case"Rati":h(a,7);break;case"Part":h(a,8);break;case"TPro":h(a,9);break;case"Equi":h(a,10);break;case"QPro":h(a,11);break;case"QRes":h(a,12)}return a}},{key:"_getPrintHtml",value:function(e){var t="";t+='<div class="table-responsive" id="result_plan_table" style="margin-bottom: 0;">',t+='<table class="table table-striped table-hover text-nowrap result-table" style="margin-bottom: 0; text-align: center; border: 0; font-size: 14px;">';var a=Le();t+=a.printPlanTableTitle()+"<tbody>";var n=60;ae()||(n=a.getTotalTime(!1));for(var i=0;i<e.length;i++){t+="<tr tabindex='0' id='print_result_plan_tr_"+i+"'>";for(var r=0;r<4;r++)t+="<td style='width: 5%;'>",t+=""+e[i][r+1],t+="</td>";for(var o=4;o<8;o++)t+="<td style='width:"+a.PlanTableResourceAndContractWidth+"'>",t+=""+Math.round(e[i][o+1]*n*10)/10,t+="</td>";for(var s=8;s<12;s++)t+="<td style='width:"+a.PlanTableResourceAndContractWidth+";'>",t+=""+Math.round(e[i][s+1]*n*100)/100,t+="</td>";for(var l=e[0].length,d=13;d<l;d++)t+="<td style='width:"+a.PlanTableResourceAndContractWidth+";'>",t+=e[i][d],t+="</td>";t+="</tr>"}return t+="</tbody>"}}]),Yt);function Yt(){_(this,Yt)}jt._lastResultsPlan=[],jt._lastSortBy,window.FineTuning_JS=!0;var Zt=(e(Xt,null,[{key:"clear",value:function(){this._TargetValue_Original=[0,0,0,0,0,0,0,0],this._TargetValue=[0,0,0,0,0,0,0,0],this._ShownTab=-1}},{key:"setFineTuning",value:function(e,t){this._TargetValue_Original=e.slice(),this._TargetValue=e.slice(),this._ShownTab=t}},{key:"getTargetValue",value:function(){return this._TargetValue.slice()}},{key:"getShownTab",value:function(){return this._ShownTab}},{key:"changeTargetValue",value:function(e,t){var a=["MT","AT","RT","PT","TT","ET","QPT","QRT"].indexOf(t);-1===e?this._TargetValue[a]-=this._TargetValue_Original[a]/50:this._TargetValue[a]+=this._TargetValue_Original[a]/50}},{key:"print",value:function(){if(Ze()){var e=document.getElementById("FineTuning"),t=["MT","AT","RT","PT","TT","ET","QPT","QRT"];if(""===e.innerHTML){var a=f.JS,n=[a.FineTuningManp,a.FineTuningAmmu,a.FineTuningRati,a.FineTuningPart,a.FineTuningTPro,a.FineTuningEqui,a.FineTuningQPro,a.FineTuningQRes],i='<div class="card" style="margin-bottom:5px">';i+='<div class="card-header">',i+='<a data-toggle="collapse" id="FineTuningTool_panelTitle" href="#FineTuningTool" class="collapsed">'+a.FineTuningTool+"</a></div>",i+='<div id="FineTuningTool" class="collapse"',I()&&(i+='style="transition: none;"'),i+=">",i+='<div class="card-body row" style="padding: 10px 5px; margin: 0; text-aligh: center;">';for(var r=0;r<8;r++){0===r&&(i+='<div class="col-lg-6 col-md-6 col-sm-6" style="padding-left: 5px; padding-right: 5px;">'),4===r&&(i+='</div> <div class="col-lg-6 col-md-6 col-sm-6" style="padding-left: 5px; padding-right: 5px;">'),i+='<div class="input-group" style="margin-bottom: 10px; width: 100%;">',i+='<span class="input-group-text input-group-span FineTuning-span" style="font-size: 14px;" id="FineTuningTool_'+t[r]+'">'+n[r]+"</span>",i+='<button class="btn btn-outline-dark input-group-btn btn-bolder FineTuning-button" style="display:block;" type="button" id="FineTuning_minus_'+t[r]+'"';var o=this._TargetValue_Original[r],s=this._TargetValue[r];(0===o||s-o/50<=0||s-o/50<.9*o)&&(i+='disabled="disabled"'),i+='title="'+f.HTMLJS.FineTuning_minus+'">-</button>',i+='<button class="btn btn-outline-dark input-group-btn btn-bolder FineTuning-button" style="display: block;" type="button" id="FineTuning_plus_'+t[r]+'"',(0===o||1<=s+o/50||1.14*o<s+o/50)&&(i+='disabled="disabled"'),i+='title="'+f.HTMLJS.FineTuning_plus+'">+</button>',i+="</div>"}i+="</div></div></div></div>",e.innerHTML=i}else for(var l=0;l<8;l++){var d=this._TargetValue_Original[l],_=this._TargetValue[l];if(0===d||_-d/50<=0||_-d/50<.8*d){var u=$("#FineTuning_minus_"+t[l]);"disabled"!==u.attr("disabled")&&u.attr("disabled","disabled")}else{var c=$("#FineTuning_minus_"+t[l]);"disabled"===c.attr("disabled")&&c.removeAttr("disabled")}if(0===d||1<=_+d/50||1.2*d<_+d/50){var m=$("#FineTuning_plus_"+t[l]);"disabled"!==m.attr("disabled")&&m.attr("disabled","disabled")}else{var h=$("#FineTuning_plus_"+t[l]);"disabled"===h.attr("disabled")&&h.removeAttr("disabled")}}}}}]),Xt);function Xt(){_(this,Xt)}Zt._TargetValue_Original=[],Zt._TargetValue=[],Zt._ShownTab=-1;var Kt=(e(ea,[{key:"_setList",value:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]=new Array(13);return t}},{key:"ranking",value:function(){for(var e=this.ShownTab.getQValidLength(),t=e-3,a=e-2,n=e-1,i=e,r=0;r<t;++r)for(var o=r+1;o<a;++o)for(var s=o+1;s<n;++s)for(var l=s+1;l<i;++l)this._calculateAndPushIntoList(r,o,s,l)}},{key:"_pushIntoList",value:function(e,t,a,n,i,r){0 in this.List[this.List_lastIndex]?this._push(e,t,a,n,i,r):this._pushIntoFirstEmpty(e,t,a,n,i,r)}},{key:"_pushIntoFirstEmpty",value:function(e,t,a,n,i,r){for(var o=this.List_lastIndex;0!==o&&!(0 in this.List[o-1]);)o--;this._pushIntoThisRow(o,e,t,a,n,i,r),this._sortList(o,i)}},{key:"_push",value:function(e,t,a,n,i,r){var o=this.List_lastIndex;i<=this.List[o][12]||(this._pushIntoThisRow(o,e,t,a,n,i,r),this._sortList(o,i))}},{key:"_pushIntoThisRow",value:function(e,t,a,n,i,r,o){this.List[e]=[t,a,n,i,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],r]}},{key:"_sortList",value:function(e,t){for(var a=e-1;0<=a&&t>this.List[a][12];a--){var n=[this.List[a],this.List[a+1]];this.List[a+1]=n[0],this.List[a]=n[1]}}}]),ea);function ea(e,t){_(this,ea),this.List=this._setList(t),this.List_length=t,this.List_lastIndex=t-1,this.ShownTab=e}var ta=(t(aa,Kt),e(aa,[{key:"_correctTargetValueHTML",value:function(){var e=_e(),t=e.slice(0,4),a=e.slice(4,8);return t=this._correctTargetValueHTML_main(t),a=this._correctTargetValueHTML_main(a),ue(e=t.concat(a)),e}},{key:"_correctTargetValueHTML_main",value:function(e){for(var t=A(e),a=Math.round(t/5e3*100)/100,n=0;n<4;n++)0!==e[n]&&(e[n]=Math.max(a,e[n]));return e}},{key:"_correctTargetValue",value:function(){var e=this._correctResourceValue(),t=this._correctContractValue(),a=e.concat(t);if(""+a=="0,0,0,0,0,0,0,0")throw F.alert(f.JS.TargetValue0_alert),"Warning: TargetValue cannot all be 0!";return a}},{key:"_correctResourceValue",value:function(){var e=this.targetValue_html.slice(0,4),t=100-me();return this._valuesNotAll0(e)&&this._correctValue(e,t),e}},{key:"_correctContractValue",value:function(){var e=this.targetValue_html.slice(4,8),t=me();return this._valuesNotAll0(e)&&this._correctValue(e,t),e}},{key:"_valuesNotAll0",value:function(e){for(var t=0;t<e.length;t++)if(0!==e[t])return!0;return!1}},{key:"_correctValue",value:function(e,t){for(var a=t/A(e),n=0;n<e.length;n++)e[n]*=a}},{key:"_getNorm",value:function(e){for(var t=0,a=0;a<8;a++)t+=Math.pow(e[a],2);return Math.pow(t,.5)}},{key:"ranking",value:function(){this.ShownTab.deleteUselessMissions(this.QValidMaxLength_1,this.targetValue),l(aa.prototype.__proto__||Object.getPrototypeOf(aa.prototype),"ranking",this).call(this),this.ShownTab.getQValidLength()>this.QValidMaxLength_2&&this.ShownTab.deleteUselessMissions(this.QValidMaxLength_2,this.targetValue,this.Qvalid_missionValue)}},{key:"_calculateAndPushIntoList_andCalculateMissionsValue",value:function(e,t,a,n){var i=this.ShownTab.calculateCurrentValue(e,t,a,n);if(-1!==i[0]){var r=this._calculateValue(i),o=this.Qvalid_missionValue;o[e]+=r,o[t]+=r,o[a]+=r,o[n]+=r,this._pushIntoList(e,t,a,n,r,i)}}},{key:"_calculateAndPushIntoList_normal",value:function(e,t,a,n){var i=this.ShownTab.calculateCurrentValue(e,t,a,n);if(-1!==i[0]){var r=this._calculateValue(i);this._pushIntoList(e,t,a,n,r,i)}}},{key:"_calculateValue",value:function(e){var t=this.targetValue,a=[0,0,0,0,0,0,0,0];0!==t[0]&&(a[0]=e[0]),0!==t[1]&&(a[1]=e[1]),0!==t[2]&&(a[2]=e[2]),0!==t[3]&&(a[3]=e[3]),0!==t[4]&&(a[4]=500*e[4]),0!==t[5]&&(a[5]=500*e[5]),0!==t[6]&&(a[6]=500*e[6]),0!==t[7]&&(a[7]=500*e[7]);var n=this._getNorm(a);if(0===n)return 0;var i=this._getDotProduct(a,t)/this._norm_target,r=i/n,o=(-.698131700797732*r*r-.872664625997164)*r+1.57079632679489,s=1-.5*(0<o?o:0);return s*s*i}},{key:"_getDotProduct",value:function(e,t){for(var a=0,n=0;n<8;n++)a+=e[n]*t[n];return a}},{key:"getStdznTargetValue",value:function(e){var t=this._getAvgCurrentByList(),a=t.slice(0,4);a.class="Resource";var n=t.slice(4,8);n.class="Contract";var i=this._getCalibration(a),r=void 0;r="PlanCombination"===e&&0!==i?i*=.8:this._getCalibration(n);for(var o=0;o<4;o++)t[o]=0!==i?this.targetValue_html[o]/i:0;for(var s=4;s<8;s++)t[s]=0!==r?this.targetValue_html[s]/r:0;return t}},{key:"_getAvgCurrentByList",value:function(){var e=[0,0,0,0,0,0,0,0],t=new Array(8),a=this.List;t.fill(this.List_length);for(var n=0;n<8;n++)for(var i=0;i<this.List_length;i++)e[n]+=a[i][n+4],0===a[i][n+4]&&t[n]--;for(var r=0;r<8;r++)0===t[r]?e[r]=0:e[r]/=t[r];return e}},{key:"_getCalibration",value:function(e){for(var t=this._getTarget0Html(e.class),a=this._getCurrent0Max(e.class),n=0,i=e.length,r=0;r<e.length;r++)0!==e[r]?(n+=t[r]/e[r],0===t[r]&&i--):i--;if(0!==n)n/=i;else{for(var o=0,s=e.length,l=0;l<e.length;l++)0!==a[l]?o+=a[l]:s--;0===s?o=0:o/=s,n=A(t)/o}return n}},{key:"_getTarget0Html",value:function(e){return new Array(4),"Resource"===e?this.targetValue_html.slice(0,4):this.targetValue_html.slice(4,8)}},{key:"_getCurrent0Max",value:function(e){return new Array(4),"Resource"===e?this.ShownTab.getCurrentValueMax().slice(0,4):this.ShownTab.getCurrentValueMax().slice(4,8)}}]),aa);function aa(e,t,a,n,i){_(this,aa);var r=d(this,(aa.__proto__||Object.getPrototypeOf(aa)).call(this,e,t)),o=r.ShownTab.getQValidLength();if(r.QValidMaxLength_1=Math.min(a,o),r.QValidMaxLength_2=Math.min(n,o),n<o){r._calculateAndPushIntoList=r._calculateAndPushIntoList_andCalculateMissionsValue;var s=new Array(r.QValidMaxLength_1);s.fill(0),r.Qvalid_missionValue=s}else r._calculateAndPushIntoList=r._calculateAndPushIntoList_normal;return i?(r.targetValue_html=i,r.targetValue=i):(r.targetValue_html=r._correctTargetValueHTML(),r.targetValue=r._correctTargetValue()),r._norm_target=r._getNorm(r.targetValue),r}var na=(t(ia,Kt),e(ia,[{key:"_calculateAndPushIntoList",value:function(e,t,a,n){var i=this.ShownTab.calculateCurrentValue(e,t,a,n);if(-1!==i[0]){var r=this._calculateValue(i);this._pushIntoList(e,t,a,n,r,i)}}},{key:"_calculateValue",value:function(e){for(var t=0,a=99999999999,n=this.targetValue,i=0;i<8;i++)0!==n[i]&&(a=Math.min(a,e[i]/n[i]));for(var r=0;r<8;r++)t+=this._calculateValue_main(n[r],e[r],a);return t}},{key:"_calculateValue_main",value:function(e,t,a){return 0===e?0:.5*(Math.min(t,e)+Math.min(t,1.5*e*a))}},{key:"getResult",value:function(){for(var e=this.ShownTab,t=e.getQValid(!0),a=e.getCurrentValueMax(),n=[],i=0;i<this.List_length;i++){var r=this.List[i];if(!(0 in r))break;var o=[];o.push(i);for(var s=new Array(4),l=0;l<4;l++)s[l]=t[r[l]][0];s=s.sort(M);for(var d=0;d<4;d++)o.push(s[d]);for(var _=0;_<8;_++)o.push(r[_+4]*a[_]);for(var u=this.ShownTab.printTableCustomize(r[0],r[1],r[2],r[3]),c=0;c<u.length;c++)o.push(u[c]);n.push(o)}return n}},{key:"print",value:function(e){var t=0<arguments.length&&void 0!==e?e:"Ranking";ze(this.getResult(),t)}}]),ia);function ia(e,t,a){_(this,ia);var n=d(this,(ia.__proto__||Object.getPrototypeOf(ia)).call(this,e,t));return n.targetValue=a,n}var ra=44,oa=34;function sa(){var e=Le();e.setQValid();var t=new ta(e,8,ra,oa);t.ranking();for(var a=t.getStdznTargetValue(),n=new Array(8),i=e.getCurrentValueMax(),r=0;r<8;r++)n[r]=Math.min(1,a[r]/i[r]),n[r]=Math.max(n[r],0);e.normalizedQValid(),Zt.setFineTuning(n,e);var o=new na(e,16,n);o.ranking(),o.print(),"none"!==document.getElementById("start_ranking").style.display&&($("#Time_Anytime_hours").attr("disabled","true"),$("#Time_Anytime_minutes").attr("disabled","true"),$("#Tab_Anytime_MinimumIntervalTime_minutes").attr("disabled","true"),$("#Time_Timetable_hours").attr("disabled","true"),$("#Time_Timetable_minutes").attr("disabled","true"),$("#tab_Timetable_deleteall").attr("disabled","true"),$("button[id^=Tab_Timetable_range_thumb_]").attr("disabled","true"),$("#Tab_Timetable_new_hours").attr("disabled","true"),$("#Tab_Timetable_new_minutes").attr("disabled","true"),$("#Tab_Timetable_AddNewTimePoint").attr("disabled","true"),$("#GreatSuccessRate").attr("disabled","true"),$("#GreatSuccessRateUp_btn").attr("disabled","true"),$("#GreatSuccessRateUp_btn").addClass("disabled"),$("#ChapterLimit").attr("disabled","true"),$("#ContractWeight").attr("disabled","true"),$("button[id^=setTarget_]").attr("disabled","true"),$("#MT").attr("disabled","true"),$("#AT").attr("disabled","true"),$("#RT").attr("disabled","true"),$("#PT").attr("disabled","true"),$("#TT").attr("disabled","true"),$("#ET").attr("disabled","true"),$("#QPT").attr("disabled","true"),$("#QRT").attr("disabled","true"),$("button[id^=Target_minus_]").attr("disabled","true"),$("button[id^=Target_plus_]").attr("disabled","true"),document.getElementById("start_ranking").style.display="none",document.getElementById("clear_ranking").style.display="")}function la(e,t){Zt.changeTargetValue(e,t);var a=Zt.getShownTab(),n=Zt.getTargetValue(),i=new na(a,16,n);i.ranking(),i.print(jt.getLastSortBy())}function da(e,t){var a=new Date(e);a.setDate(a.getDate()+t);var n=a.getMonth()+1;(n+"").length<2&&(n="0"+n);var i=a.getDate();return(i+"").length<2&&(i="0"+i),a.getFullYear()+"-"+n+"-"+i}function _a(e,t){var a=new Date(e);return(new Date(t)-a)/864e5}function ua(e){for(var t=e[0],a=0,n=e.length,i=0;i<n;i++)t<e[i]&&(t=e[i],a=i);return a}var ca="GF_Logistics_PC_v"+s.slice(0,s.indexOf("."))+".x.x";function ma(e,t){if(N){var a=localStorage.getItem(ca);try{a=JSON.parse(a)}catch(e){console.error("storageGetItem, storage: "+a),a={}}null===a&&(a={}),a[e]=t,a.version=s,a=JSON.stringify(a),localStorage.setItem(ca,a)}}function ha(e){if(N){var t=localStorage.getItem(ca);if(null===t)return"noStorage";try{t=JSON.parse(t)}catch(e){console.error("storageGetItem, storage: "+t),t={}}var a=t[e];return void 0===a?"noStorage":a}return"noStorage"}var va=document.getElementById("PlanCombination_planStartDate"),pa=document.getElementById("PlanCombination_planEndDate"),ga=document.getElementById("PlanCombination_startDate"),Ta=document.getElementById("PlanCombination_endDate");function ba(e){var t=0<arguments.length&&void 0!==e&&e,a=ga,n=a.value,i=a.getAttribute("min"),r=a.getAttribute("max");return(""===n||n<i||r<n)&&(n=(new Date).toISOString().slice(0,10),t&&(a.value=n)),n}function fa(e){ma("Date",{start:ga.value=e,end:Pa()})}function ya(){var e=ga,t=da(Pa(),-1);e.setAttribute("max",t)}function Pa(e){var t=0<arguments.length&&void 0!==e&&e,a=Ta,n=a.value,i=a.getAttribute("min"),r=a.getAttribute("max");return(""===n||n<i||r<n)&&(n=da((new Date).toISOString().slice(0,10),7),t&&(a.value=n)),n}function Ca(e){Ta.value=e,ma("Date",{start:ba(),end:e})}function Sa(){var e=Ta,t=da(ba(),1);e.setAttribute("min",t)}function ka(e){var t=0<arguments.length&&void 0!==e&&e,a=va,n=a.value,i=ba(),r=da(Pa(),-1);return new Date(n)<new Date(i)||new Date(n)>new Date(r)?(t&&(a.value=""),"error"):n}function wa(){var e=va,t=ba();e.setAttribute("min",t);var a=void 0,n=Aa();a=da(""!==n?n:Pa(),-1),e.setAttribute("max",a)}function Aa(e){var t=0<arguments.length&&void 0!==e&&e,a=pa,n=a.value,i=da(ba(),1),r=Pa();return new Date(n)<new Date(i)||new Date(n)>new Date(r)?(t&&(a.value=""),"error"):n}function Da(){var e=pa,t=Pa();e.setAttribute("max",t);var a=void 0,n=ka();a=da(""!==n?n:ba(),1),e.setAttribute("min",a)}function Ma(){for(var e=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],t=[],a=0;a<8;++a){var n=w($("#Consumption_"+e[a]));t.push(n)}return t}function Ia(e){for(var t=0<arguments.length&&void 0!==e?e:["","","","","","","",""],a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=0;n<8;++n)$("#Consumption_"+a[n]).val(t[n])}function xa(){return C($("#Consumption_times"))}function $a(e){var t=0<arguments.length&&void 0!==e?e:"1";$("#Consumption_times").val(t)}function La(e){for(var t=0<arguments.length&&void 0!==e&&e,a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=[],i=0;i<8;++i)n.push(C($("#PC_demand_"+a[i]),t));return n}function Ra(e){for(var t=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],a=0;a<8;++a)$("#PC_demand_"+t[a]).val(e[a]);ma("demand",e)}function Ea(e){for(var t=0<arguments.length&&void 0!==e&&e,a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=[],i=0;i<8;++i)n.push(C($("#PC_current_"+a[i]),t)),i<4&&3e5<n[i]&&(n[i]=3e5,t&&$("#PC_current_"+a[i]).val(n[i]));return n}function Fa(e){for(var t=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],a=0;a<8;++a)$("#PC_current_"+t[a]).val(e[a]);ma("current",e)}function Va(e){for(var t=0<arguments.length&&void 0!==e&&e,a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=[],i=0;i<8;++i)n.push(C($("#PC_target_"+a[i]),t)),i<4&&3e5<n[i]&&(n[i]=3e5,t&&$("#PC_target_"+a[i]).val(n[i]));return n}function Na(e){for(var t=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],a=0;a<8;++a)$("#PC_target_"+t[a]).val(e[a]);ma("target",e)}function Ba(e){if(""===$("#CommanderLevel").val())return-1;var t=S($("#CommanderLevel"));return t=Math.max(1,t),e&&t!=$("#CommanderLevel").val()&&$("#CommanderLevel").val(t),t}function Qa(e){-1===e?$("#CommanderLevel").val(""):$("#CommanderLevel").val(e),ma("level",e)}var Ja=(e(Ha,null,[{key:"add",value:function(){var e=ka(!0),t=Aa(!0);if(""!==e&&""!==t)if("error"!==e&&"error"!==t){var a=this._getATimePeriodHTML(e,t,this._number++);this._timePeriod.push([e,t]),$("#PC_DateTimePeriod_body").append(a)}else F.alert(f.JS.PCTimeAlert2);else F.alert(f.JS.PCTimeAlert1)}},{key:"_getATimePeriodHTML",value:function(e,t,a){var n="";return n+='<code class="list-group-item p-2" id="PC_TimePeriod_'+a+'">',n+=e+" ~ "+t+'<button class="close" title="'+f.JS.delete_+'" id="PC_TimePeriod_close_'+a+'">×</button></code>'}},{key:"deleteThisRow",value:function(e){for(var t=document.getElementById(e),a=0;;){if($("#PC_DateTimePeriod_body").children()[a].id===e){document.getElementById("PC_DateTimePeriod_body").removeChild(t);break}++a}this._timePeriod.splice(a,1)}},{key:"clear",value:function(){var e=this._timePeriod;return this._timePeriod=[],this._number=0,$("#PC_DateTimePeriod_body").html(""),va.value="",pa.value="",wa(),Da(),e}},{key:"getTimePeriod",value:function(){for(var e=[],t=this._timePeriod.length,a=0;a<t;++a)e.push(this._timePeriod[a].slice());return e.slice()}},{key:"setTimePeriod",value:function(e){this.clear();for(var t=e.length,a=ba(),n=0;n<t;++n){var i=da(a,e[n][0]),r=da(a,e[n][1]);this._timePeriod.push([i,r]);var o=this._getATimePeriodHTML(i,r,this._number++);$("#PC_DateTimePeriod_body").append(o)}}}]),Ha);function Ha(){_(this,Ha)}Ja._timePeriod=[],Ja._number=0;var Oa=(e(Ga,null,[{key:"init",value:function(e){if(this._table_clear(),"noStorage"!==e&&void 0!==e)this._startDate=e.startDate,this._endDate=e.endDate,this._totalDays=e.totalDays,this._planFlag=e.planFlag,this._plans=e.plans,this._plansNumber=e.plansNumber,0!==this._plans.length&&ln();else{var t=ba(),a=Pa(),n=_a(this._startDate=t,this._endDate=a);0<n&&(this._totalDays=n,this._planFlag=new Array(n),this._planFlag.fill(0)),this._plans=[],this._plansNumber=0}this.setStorage()}},{key:"changeDate",value:function(e,t){var a={};a.startDate=e,a.endDate=t,a.totalDays=_a(e,t),a.plansNumber=this._plansNumber;var n=this._startDate,i=this._endDate,r=_a(n,e),o=_a(i,t);0<r?this._changeDate_PostponeStartDate(r):r<0&&this._changeDate_AdvanceStartDate(-r),0<o?this._changeDate_PostponeEndDate(o):o<0&&this._changeDate_AdvanceEndDate(-o,a.totalDays),a.planFlag=this._planFlag,a.plans=this._plans,this.init(a)}},{key:"_changeDate_PostponeStartDate",value:function(e){this._planFlag.splice(0,e);for(var t=0;t<this._plans.length;++t){for(var a=this._plans[t],n=0;n<a.timePeriod.length;++n)a.timePeriod[n][1]<=e?(a.timePeriod.splice(n,1),--n):(a.timePeriod[n][0]=Math.max(a.timePeriod[n][0]-e,0),a.timePeriod[n][1]-=e);0!==a.timePeriod.length?a.TimetableData=this._calcTimetableData(a.timePeriod):(this._plans.splice(t,1),--t)}}},{key:"_changeDate_AdvanceStartDate",value:function(e){for(var t=0;t<e;++t)this._planFlag.unshift(0);for(var a=0;a<this._plans.length;++a){for(var n=this._plans[a],i=0;i<n.timePeriod.length;++i)n.timePeriod[i][0]+=e,n.timePeriod[i][1]+=e;n.TimetableData=this._calcTimetableData(n.timePeriod)}}},{key:"_changeDate_PostponeEndDate",value:function(e){for(var t=0;t<e;++t)this._planFlag.push(0)}},{key:"_changeDate_AdvanceEndDate",value:function(e,t){this._planFlag.splice(-e,e);for(var a=0;a<this._plans.length;++a){for(var n=this._plans[a],i=0;i<n.timePeriod.length;++i)n.timePeriod[i][0]>=t?(n.timePeriod.splice(i,1),--i):n.timePeriod[i][1]=Math.min(n.timePeriod[i][1],t);0!==n.timePeriod.length?n.TimetableData=this._calcTimetableData(n.timePeriod):(this._plans.splice(a,1),--a)}}},{key:"reset",value:function(){var e=ba(),t=Pa();this._startDate=e,this._endDate=t,this._plans=[],this._table_clear(),this._plansNumber=0,this._tableNumber=0;var a=_a(e,t);0<a&&(this._totalDays=a,this._planFlag=new Array(a),this._planFlag.fill(0))}},{key:"setStorage",value:function(){ma("ConsumptionPlan",this.exportData())}},{key:"exportData",value:function(){var e={};return e.startDate=this._startDate,e.endDate=this._endDate,e.totalDays=this._totalDays,e.planFlag=this._planFlag,e.plans=this._plans,e.plansNumber=this._plansNumber,e}},{key:"table_add",value:function(){var e=Ma(),t=xa(),a=this._table_getHTML(e,t);$("#Consumption_tbody").append(a);for(var n=this._tableData,i=0;i<8;++i)n[0][i]+=e[i]*t;e.push(t),n.push(e),this._table_printTotal(this._tableData[0])}},{key:"_table_getHTML",value:function(e,t){for(var a=this._tableNumber++,n='<tr id="Consumption_table_row_'+a+'">',i=0;i<8;++i)n+="<td>",0<e[i]&&(n+="+"),n+=b(e[i])+"</td>";return n+="<td>"+t+"</td>",n+='<td style="min-width: 3.2rem;"><button id="Consumption_table_apply_row_'+a+'" style="float: left;" class="close" title="'+f.JS.apply+'">✓</button>',n+='<button id="Consumption_table_close_row_'+a+'" class="close" title="'+f.JS.delete_+'">×</button></td>'}},{key:"_table_deleteThisRow",value:function(e){for(var t=document.getElementById(e),a=0;;){if($("#Consumption_tbody").children()[a].id===e){document.getElementById("Consumption_tbody").removeChild(t);break}++a}for(var n=this._tableData[a+1],i=0;i<8;++i){var r=n[8];this._tableData[0][i]-=n[i]*r}this._table_printTotal(this._tableData[0]),this._tableData.splice(a+1,1)}},{key:"table_applyThisRow",value:function(e){document.getElementById(e);for(var t=0;$("#Consumption_tbody").children()[t].id!==e;)++t;Ia(this._tableData[t+1]),$a(this._tableData[t+1][8])}},{key:"_table_clear",value:function(){this._tableData=[[0,0,0,0,0,0,0,0]],this._tableNumber=0,document.getElementById("Consumption_tbody").innerHTML="",this._table_printTotal(this._tableData[0])}},{key:"_table_printTotal",value:function(e){for(var t="<tr>",a=0;a<8;++a)t+="<td>",0<e[a]&&(t+="+"),t+=b(e[a])+"</td>";t+='<td colspan="2" id="consumption_total_td">'+f.JS.consumption_total_td+"</td>",t+="</tr>",document.getElementById("Consumption_total").innerHTML=t}},{key:"add",value:function(){var e=Ja.getTimePeriod(),t=e.length;if(0!==t)if(32<=this._plans.length)F.alert(f.JS.PC_L_alert3);else{for(var a=this._planFlag.slice(),n=0;n<t;++n){e[n][0]=_a(this._startDate,e[n][0]),e[n][1]=_a(this._startDate,e[n][1]);for(var i=e[n][0],r=e[n][1],o=i;o<r;++o)if(++this._planFlag[o],1<this._planFlag[o]){this._planFlag=a;var s=da(this._startDate,o);return void F.alert(f.JS.PC_C_alert2_1+s+f.JS.PC_C_alert2_2)}}var l=this._calcTimetableData(e),d={};d.timePeriod=e,d.number=this._plansNumber++,d.reAndco=this._tableData[0].slice(),d.TimetableData=l;for(var _=[],u=0;u<this._tableData.length;++u)_.push(this._tableData[u].slice());d.tableData=_.slice(),this._plans.push(d),Ja.clear(),ln(),this._plansHasChanged()}else F.alert(f.JS.PC_L_alert1)}},{key:"_calcTimetableData",value:function(e){for(var t=e.length,a=[240],n=0;n<t;++n)a.push(e[n][0]),a.push(1680),a.push(e[n][1]-e[n][0]);return a}},{key:"apply",value:function(e){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!0,_n(),this._table_clear();for(var t=0;this._plans[t].number!==e;)++t;Ja.setTimePeriod(this._plans[t].timePeriod);var a=[];void 0===this._plans[t].tableData?(a.push(this._plans[t].reAndco.slice()),a.push(this._plans[t].reAndco.slice()),a[1].push(1)):a=this._plans[t].tableData;for(var n=1;n<a.length;++n){var i=a[n],r=this._table_getHTML([i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]],i[8]);$("#Consumption_tbody").append(r)}this._table_printTotal(this._plans[t].reAndco),this._tableData=[];for(var o=0;o<a.length;++o)this._tableData.push(a[o].slice())}},{key:"deleteAll",value:function(){this.reset(),dn(),this._plansHasChanged()}},{key:"deleteThis",value:function(e){for(var t=0;this._plans[t].number!==e;)++t;for(var a=this._plans[t].timePeriod.length,n=0;n<a;++n)for(var i=this._plans[t].timePeriod[n][0],r=this._plans[t].timePeriod[n][1],o=i;o<r;++o)this._planFlag[o]=0;this._plans.splice(t,1),this._plansHasChanged(),0===this._plans.length&&0===qa._plans.length&&dn()}},{key:"_plansHasChanged",value:function(){ja.printFromConsumptionPlan(this._plans),this.setStorage()}},{key:"chartGetPlans",value:function(){return this._plans}}]),Ga);function Ga(){_(this,Ga)}Oa._plans=[],Oa._plansNumber=0,Oa._startDate="",Oa._endDate="",Oa._totalDays=0,Oa._planFlag=[],Oa._tableNumber=0,Oa._tableData=[[0,0,0,0,0,0,0,0]];var Wa=(e(za,null,[{key:"save",value:function(){36<=this._saved.length?F.alert(f.JS.Saved_alert2):F.prompt(f.JS.plzInputConsumptionName,f.JS.ConsumptionSaved_prompt_title,za._saveThisPlan_ok,function(){},"text",f.JS.planDefaultName,za.checkNameValid,function(e){return""},za.invalidNameFeedback)}},{key:"_saveThisPlan_ok",value:function(e){var t={};t.name=e,t.data=Ma().slice(),t.data.push(xa()),za._saved.push(t),ma("ConsumptionSaved",za._saved),za._printLastSaved()}},{key:"_printLastSaved",value:function(){var e=this._saved.length-1;0==e&&(document.getElementById("consumption_noSaved").style.display="none");var t=this._getSavedRowHTML(e);$("#consumption_saved").append(t)}},{key:"_getSavedRowHTML",value:function(e,t){var a=1<arguments.length&&void 0!==t?t:this._saved,n='<a class="dropdown-item dropdown-item-regular" id="consumption_saved_row_';return n+=e+'"><span class="dropdown-item-span" id="consumption_span_row_',n+=e+'" title="',n+=a[e].name+'">',n+=a[e].name,n+='</span><button class="close" id="consumption_close_row_',n+=e+'">×</button></a>'}},{key:"checkNameValid",value:function(e){return""!==e&&e.length<=30}},{key:"invalidNameFeedback",value:function(e){return""===e?f.JS.TargetSaved_invalidNameFeedback1:30<=e.length?f.JS.TargetSaved_invalidNameFeedback2:""}},{key:"click",value:function(e){if(!0!==this._deleteFlag){var t=this._saved[e].data;Ia(t.slice(0,8)),$a(t[8])}else this._deleteFlag=!1}},{key:"delete",value:function(e){for(var t=e;t<this._saved.length-1;t++){var a=$("#consumption_span_row_"+t);a.html(this._saved[t+1].name),a.attr("title",this._saved[t+1].name)}var n=document.getElementById("consumption_saved_row_"+(this._saved.length-1));document.getElementById("consumption_saved").removeChild(n),this._saved.splice(e,1),0===this._saved.length&&(document.getElementById("consumption_noSaved").style.display=""),ma("ConsumptionSaved",this._saved),this._deleteFlag=!0,setTimeout(function(){$("#setTarget_saved_dropdown").dropdown("show")},0)}},{key:"setSaved",value:function(e){if(0===(this._saved=e).length)document.getElementById("consumption_noSaved").style.display="",document.getElementById("consumption_saved").innerHTML="";else{document.getElementById("consumption_noSaved").style.display="none";for(var t="",a=0;a<this._saved.length;a++)t+=this._getSavedRowHTML(a);document.getElementById("consumption_saved").innerHTML=t}return ma("ConsumptionSaved",this._saved),!0}}]),za);function za(){_(this,za)}Wa._saved=[],Wa._deleteFlag=!1;var qa=(e(Ua,null,[{key:"init",value:function(e){if("noStorage"!==e&&void 0!==e)this._startDate=e.startDate,this._endDate=e.endDate,this._totalDays=e.totalDays,this._totalTimePerDay=e.totalTimePerDay,this._plans=e.plans,this._plansNumber=e.plansNumber,0!==this._plans.length&&ln();else{var t=ba(),a=Pa(),n=_a(this._startDate=t,this._endDate=a);0<n&&(this._totalDays=n,this._totalTimePerDay=new Array(n),this._totalTimePerDay.fill(0)),this._plans=[],this._plansNumber=0}this.setStorage()}},{key:"changeDate",value:function(e,t){var a={};a.startDate=e,a.endDate=t,a.totalDays=_a(e,t),a.plansNumber=this._plansNumber;var n=this._startDate,i=this._endDate,r=_a(n,e),o=_a(i,t);0<r?this._changeDate_PostponeStartDate(r,e):r<0&&this._changeDate_AdvanceStartDate(-r),0<o?this._changeDate_PostponeEndDate(o):o<0&&this._changeDate_AdvanceEndDate(-o,e,a.totalDays),a.totalTimePerDay=this._totalTimePerDay,a.plans=this._plans,this.init(a)}},{key:"_changeDate_PostponeStartDate",value:function(e,t){this._totalTimePerDay.splice(0,e);for(var a=0;a<this._plans.length;++a){for(var n=this._plans[a],i="",r=0;r<n.timePeriod.length;++r)n.timePeriod[r][1]<=e?(n.timePeriod.splice(r,1),--r):(n.timePeriod[r][0]=Math.max(n.timePeriod[r][0]-e,0),n.timePeriod[r][1]-=e,i+=da(t,n.timePeriod[r][0]).slice(5)+"~",i+=da(t,n.timePeriod[r][1]).slice(5)+", ");0!==n.timePeriod.length?(i=i.slice(0,-2),n.saved.name=i):(this._plans.splice(a,1),--a)}}},{key:"_changeDate_AdvanceStartDate",value:function(e){for(var t=0;t<e;++t)this._totalTimePerDay.unshift(0);for(var a=0;a<this._plans.length;++a)for(var n=this._plans[a],i=0;i<n.timePeriod.length;++i)n.timePeriod[i][0]+=e,n.timePeriod[i][1]+=e}},{key:"_changeDate_PostponeEndDate",value:function(e){for(var t=0;t<e;++t)this._totalTimePerDay.push(0)}},{key:"_changeDate_AdvanceEndDate",value:function(e,t,a){this._totalTimePerDay.splice(-e,e);for(var n=0;n<this._plans.length;++n){for(var i=this._plans[n],r="",o=0;o<i.timePeriod.length;++o)i.timePeriod[o][0]>=a?(i.timePeriod.splice(o,1),--o):(i.timePeriod[o][1]=Math.min(i.timePeriod[o][1],a),r+=da(t,i.timePeriod[o][0]).slice(5)+"~",r+=da(t,i.timePeriod[o][1]).slice(5)+", ");0!==i.timePeriod.length?(r=r.slice(0,-2),i.saved.name=r):(this._plans.splice(n,1),--n)}}},{key:"reset",value:function(){var e=ba(),t=Pa();this._startDate=e,this._endDate=t,this._plans=[],this._plansNumber=0;var a=_a(e,t);0<a&&(this._totalDays=a,this._totalTimePerDay=new Array(a),this._totalTimePerDay.fill(0)),this.setStorage()}},{key:"setStorage",value:function(){ma("LogisticsPlan",this.exportData())}},{key:"exportData",value:function(){var e={};return e.startDate=this._startDate,e.endDate=this._endDate,e.totalDays=this._totalDays,e.totalTimePerDay=this._totalTimePerDay,e.plans=this._plans,e.plansNumber=this._plansNumber,e}},{key:"add",value:function(){var e=Ja.getTimePeriod(),t=e.length;if(0!==t)if(32<=this._plans.length)F.alert(f.JS.PC_L_alert3);else{for(var a="",n=0;n<t;++n)a+=e[n][0].slice(5)+"~"+e[n][1].slice(5)+", ",e[n][0]=_a(this._startDate,e[n][0]),e[n][1]=_a(this._startDate,e[n][1]);a=a.slice(0,-2);for(var i=Le().getTotalTime(),r=this._totalTimePerDay.slice(),o=0;o<t;++o)for(var s=e[o][0],l=e[o][1],d=s;d<l;++d)if(this._totalTimePerDay[d]+=i,1440<this._totalTimePerDay[d]){this._totalTimePerDay=r;var _=da(this._startDate,d);return void F.alert(f.JS.PC_L_alert2_1+_+f.JS.PC_L_alert2_2)}var u=rt.getSavedDataFromPage(a),c={};c.timePeriod=e,c.saved=u,c.time=i,c.number=this._plansNumber++,c.reAndco=rt.getReAndCoBySaved(c.saved,!1),this._plans.push(c),Ja.clear(),ln(),this._plansHasChanged()}else F.alert(f.JS.PC_L_alert1)}},{key:"apply",value:function(e){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!1,un();for(var t=0;this._plans[t].number!==e;)++t;rt.apply(this._plans[t].saved),Ja.setTimePeriod(this._plans[t].timePeriod)}},{key:"deleteAll",value:function(){this.reset(),dn(),this._plansHasChanged()}},{key:"deleteThis",value:function(e){for(var t=0;this._plans[t].number!==e;)++t;for(var a=this._plans[t].time,n=this._plans[t].timePeriod.length,i=0;i<n;++i)for(var r=this._plans[t].timePeriod[i][0],o=this._plans[t].timePeriod[i][1],s=r;s<o;++s)this._totalTimePerDay[s]-=a;this._plans.splice(t,1),this._plansHasChanged(),0===this._plans.length&&0===Oa._plans.length&&dn()}},{key:"_plansHasChanged",value:function(){ja.printFromLogisticsPlan(this._plans),this.setStorage()}},{key:"chartGetPlans",value:function(){return this._plans}},{key:"rankingGetPlans",value:function(){return this._plans}}]),Ua);function Ua(){_(this,Ua)}qa._plans=[],qa._plansNumber=0,qa._startDate="",qa._endDate="",qa._totalDays=0,qa._totalTimePerDay=[];var ja=(e(Ya,null,[{key:"resize_Timetable",value:function(){var e=document.getElementById("PlanCombination_chart");null!==e.getAttribute("_echarts_instance_")&&document.getElementById("PlanCombinationSwitch").checked&&""!==e.getAttribute("_echarts_instance_")&&echarts.getInstanceByDom(e).resize()}},{key:"printFromLogisticsPlan",value:function(e){var t=Oa.chartGetPlans();this.print(e,t)}},{key:"printFromConsumptionPlan",value:function(e){var t=qa.chartGetPlans();this.print(t,e)}},{key:"print",value:function(e,t){var a=void 0;a=void 0===e?0:e.length;var n=void 0;n=void 0===t?0:t.length,0===a&&0===n?this._print_main():0===a&&0!==n?this._print_main(void 0,t):0!==a&&0===n?this._print_main(e):0!==a&&0!==n&&this._print_main(e,t)}},{key:"_print_main",value:function(e,t){var a=0<arguments.length&&void 0!==e?e:[{timePeriod:[0,0],time:0,number:-1,reAndco:[]}],n=1<arguments.length&&void 0!==t?t:[{timePeriod:[0,0],TimetableData:[0],number:-1,reAndco:[]}],i=document.getElementById("PlanCombination_chart"),r=void 0;null===i.getAttribute("_echarts_instance_")||""===i.getAttribute("_echarts_instance_")?r=echarts.init(i):((r=echarts.getInstanceByDom(i)).off("click"),r.clear());var o=ba(),s=Pa(),l=_a(o,s);this._LogisticsTimetableOriginalData=a,this._ConsumptionTimetableOriginalData=n,this._LogisticsTimetableData=this._LogisticsPlanDataToTimetableData(a,l),this._ConsumptionTimetableData=this._ConsumptionPlanDataToTimetableData(n,l);var d=Ea(!0);this._reAndcoData=this._calcReAndCoData(d,a,n,l),this._reAndcoData=this._resourceRegen(l),this._reAndcoData=this._reAndcoDataToChartData(l);var _=function(n,e){for(var t=_a(n,e),i=new Array(t+1),a=0;a<t+1;++a)i[a]=da(n,a);var r=n.slice(0,4)===e.slice(0,4),o=(f.JS,!1),s=Ba(),l=mn(s),d=void 0;return d=-1!==s?[{yAxis:0},{yAxis:l},{yAxis:3e5}]:[{yAxis:0},{yAxis:3e5}],I()||(o=!0),{grid:[{left:60,right:45,bottom:125,height:125,tooltip:{trigger:"axis",axisPointer:{type:"line"}}},{left:60,right:45,bottom:55,height:70,tooltip:{type:"item"}}],tooltip:{trigger:"item",backgroundColor:"rgba(245, 245, 245, 0.9)",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#000"},position:function(e,t,a,n,i){var r={top:10};return r[["left","right"][+(e[0]<i.viewSize[0]/2)]]=30,r},formatter:function(e){var t="";t+=i[e[0].axisValue]+"&nbsp;&nbsp;0:00<br>";for(var a=0;a<e.length;++a){t+=e[a].marker+e[a].seriesName+": ";var n=e[a].data[1];n<0?t+='<span style="color: red;">':0===n?t+="<span>":n<l&&e[a].componentIndex<4?t+='<span style="color: blue;">':3e5<=n&&e[a].componentIndex<4?t+='<span style="color: green;">':t+="<span>",t+=n.toLocaleString()+"</span><br>"}return t},extraCssText:"width: 170px"},toolbox:{left:16,bottom:60,feature:{saveAsImage:{name:"GF",title:"Save"}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],minValueSpan:7,filterMode:"none"},{show:!0,xAxisIndex:[0,1],type:"slider",showDataShadow:!1,bottom:9,height:10,filterMode:"none",borderColor:"transparent",backgroundColor:"#e2e2e2",handleIcon:"M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",handleSize:16,handleStyle:{shadowBlur:6,shadowOffsetX:1,shadowOffsetY:2,shadowColor:"#aaa"},minValueSpan:7,labelFormatter:""}],legend:{left:0},xAxis:[{type:"value",min:0,max:t,axisTick:{show:!1},scale:!0,axisLabel:{show:!1},boundaryGap:!1,gridIndex:0,axisLine:{onZero:!1}},{type:"value",min:0,scale:!0,minInterval:1,axisLabel:{formatter:function(e){var t=da(n,e),a=t.slice(5);return r?a:a+"\n"+t.slice(0,4)}},max:t,gridIndex:1}],yAxis:[{name:f.JS.resource,nameGap:9,type:"value",scale:!0,gridIndex:0,splitLine:{show:!1},minInterval:1},{name:f.JS.contract,nameGap:9,type:"value",scale:!0,gridIndex:0,splitLine:{show:!1},minInterval:1},{max:1680,interval:1440,axisLine:{show:!0,step:1440},axisLabel:{show:!1},axisTick:{show:!1,alignWithLabel:!0},gridIndex:1}],series:[{name:f.JS.Manp,data:ja._reAndcoData[0],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:f.JS.Ammu,data:ja._reAndcoData[1],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:f.JS.Rati,data:ja._reAndcoData[2],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:f.JS.Part,data:ja._reAndcoData[3],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:f.JS.TPro,data:ja._reAndcoData[4],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{name:f.JS.Equi,data:ja._reAndcoData[5],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{name:f.JS.QPro,data:ja._reAndcoData[6],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{name:f.JS.QRes,data:ja._reAndcoData[7],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{type:"custom",renderItem:Za,encode:{x:[0,1],y:2,itemName:3},data:ja._LogisticsTimetableData,clip:!0,xAxisIndex:1,yAxisIndex:2,tooltip:{formatter:function(e){var t=e.dataIndex,a=f.JS.chartTooltip_L,n=ja._LogisticsTimetableOriginalData[t].saved.Missions,i=["#A1C0FF","#FF8C8A","#75d874","#FFDA93"],r=a+"<br>";r+=f.JS.Mission+": <br>";for(var o=0;o<n.length;++o)r+="<span style='display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:"+i[o]+";'></span>",r+=n[o]+"<br>";return r}}},{type:"custom",renderItem:Xa,data:ja._ConsumptionTimetableData,clip:!0,xAxisIndex:1,yAxisIndex:2,tooltip:{formatter:function(e){for(var t=e.dataIndex,a=f.JS.chartTooltip_C,n=ja._ConsumptionTimetableOriginalData[t].reAndco,i=a+"<br>",r=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a"],o=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],s=0;s<8;++s)i+="<span style='display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:"+r[s]+";'></span>",i+=f.JS[o[s]],i+=": ",0<n[s]?i+='<span style="color: green;">+':n[s]<0?i+='<span style="color: red;">':i+="<span>",i+=b(n[s]).toLocaleString()+"</span><br>";return i}}}],animation:o}}(o,s);r.setOption(_),r.on("click",{seriesIndex:8},function(e){Ka(e)}),r.on("click",{seriesIndex:9},function(e){Ka(e)}),$("#PC_deletePlan").off(),$("#PC_deletePlan").attr("disabled","true")}},{key:"_LogisticsPlanDataToTimetableData",value:function(e,t){var a=[],n=new Array(t);n.fill(0);for(var i=e.length,r=0;r<i;++r){var o={};o.name=e[r].number;var s=e[r],l=s.time;o.value=[l];for(var d=s.timePeriod.length,_=0;_<d;++_)for(var u=s.timePeriod[_][0],c=s.timePeriod[_][1],m=-1,h=u;h<c;++h){n[h]+=l;var v=n[h],p=o.value;if(v===m)p[p.length-1]++;else{var g=h;p.push(g),p.push(v),p.push(1),m=n[h]}}o.itemStyle={},o.itemStyle.color=this.colorList[r],o.emphasis={itemStyle:{borderColor:"#000",borderWidth:2}},a.push(o)}return a}},{key:"_ConsumptionPlanDataToTimetableData",value:function(e){for(var t=[],a=e.length,n=0;n<a;++n){var i={};i.name=e[n].number,i.value=e[n].TimetableData,i.itemStyle={},i.itemStyle.color=this.colorList[32+n],i.emphasis={itemStyle:{borderColor:"#000",borderWidth:2}},t.push(i)}return t}},{key:"_calcReAndCoData",value:function(e,t,a,n){for(var i=[],r=0;r<8;++r){var o=new Array(n);o.fill(0),o[0]=e[r];for(var s=t.length,l=0;l<s;++l)for(var d=t[l].reAndco[r],_=t[l].timePeriod.length,u=0;u<_;++u)for(var c=t[l].timePeriod[u][0],m=t[l].timePeriod[u][1],h=c;h<m;++h)o[h]+=d;for(var v=a.length,p=0;p<v;++p)for(var g=a[p].reAndco[r],T=a[p].timePeriod.length,b=0;b<T;++b)for(var f=a[p].timePeriod[b][0],y=a[p].timePeriod[b][1],P=f;P<y;++P)o[P]+=g;o[0]=r<4?Math.min(Math.round(o[0]),3e5):Math.round(o[0]);for(var C=1;C<n;++C){var S=Math.round(o[C]+o[C-1]);o[C]=!(r<4)||S<3e5?S:3e5}o.unshift(Math.round(e[r])),i.push(o)}return i}},{key:"_resourceRegen",value:function(e){var t=Ba(!0);if(-1===t)return this._reAndcoData;for(var a=mn(t),n=[1440,1440,1440,480],i=0;i<4;++i)for(var r=this._reAndcoData[i],o=0,s=1;s<=e;++s)if(r[s]+o<a){var l=o+n[i];r[s]+l>a&&(l=a-r[s]),r[s]=Math.min(l+r[s],3e5),o=l}else r[s]=Math.min(o+r[s],3e5);return this._reAndcoData}},{key:"_reAndcoDataToChartData",value:function(e){for(var t=[],a=0;a<8;++a){for(var n=[],i=this._reAndcoData[a],r=0;r<=e;++r)n.push([r,i[r]]);t.push(n)}return t}}]),Ya);function Ya(){_(this,Ya)}function Za(e,t){for(var a=t.style(),n=[],i=t.value(0),r=e.dataIndex,o=ja._LogisticsTimetableData[r].value,s=0;!isNaN(o[3*s+1]);){var l=t.coord([o[3*s+1],o[3*s+2]]),d=t.size([o[3*s+3],i]),_={type:"rect",shape:{}};_.shape.x=l[0],_.shape.y=l[1],_.shape.width=d[0],_.shape.height=d[1],_.style=a,_.styleEmphasis=t.styleEmphasis(),n.push(_),++s}return{type:"group",children:n}}function Xa(e,t){for(var a=t.style(),n=[],i=t.value(0),r=e.dataIndex,o=ja._ConsumptionTimetableData[r].value,s=0;!isNaN(o[3*s+1]);){var l=t.coord([o[3*s+1],o[3*s+2]]),d=t.size([o[3*s+3],i]),_={type:"rect",shape:{}};_.shape.x=l[0],_.shape.y=l[1],_.shape.width=d[0],_.shape.height=d[1],_.style=a,_.styleEmphasis=t.styleEmphasis(),n.push(_),++s}return{type:"group",children:n}}function Ka(e){var t=e.seriesIndex,a=e.data.name;8===t?qa.apply(a):Oa.apply(a),$("#PC_deletePlan").removeAttr("disabled"),$("#PC_deletePlan").off(),$("#PC_deletePlan").on("click",function(){8===t?qa.deleteThis(a):Oa.deleteThis(a),$("#PC_deletePlan").attr("disabled","true")}),8===t&&rt.cancelSelected();var n=document.getElementById("PlanCombination_chart");if(null!==n.getAttribute("_echarts_instance_")&&""!==n.getAttribute("_echarts_instance_")){var i=echarts.getInstanceByDom(n);i.dispatchAction({type:"downplay",seriesIndex:[8,9]}),i.dispatchAction({type:"highlight",seriesIndex:t,dataIndex:e.dataIndex})}}ja.colorList=["#da0d68","#975e6d","#fde404","#0aa3b5","#9db2b7","#e0719c","#f99e1c","#4eb849","#ef5a78","#f7f1bd","#dd4c51","#3e0317","#6569b0","#c94a44","#f2684b","#aeb92c","#f68a5c","#baa635","#f7a128","#e2631e","#7eb138","#e1c315","#9ea718","#94a76f","#d0b24f","#b09733","#8f1c53","#b34039","#ba9232","#8b6439","#187a2f","#62aa3c","#038549","#28b44b","#7ac141","#5e9a80","#8b8c90","#beb276","#744e03","#a3a36f","#c9b583","#978847","#9d977f","#cc7b6a","#db646a","#76c0cb","#80a89d","#def2fd","#7a9bae","#039fb8","#5e777b","#caa465","#dfbd7e","#be8663","#899893","#a1743b","#894810","#c78936","#8c292c","#e5762e","#c78869","#d4ad12","#692a19"];var en=void 0;var tn=(e(an,[{key:"ranking",value:function(e){var t=0<arguments.length&&void 0!==e?e:0;if(0===t&&(this._planValue_total=0,F.progress(),this._noPlan=0),t<this.allPlan.length){var a=t,n=this.allPlan[a],i=this.original_demandValue;n.ranking(i),this._planValue_total+=n.planValue}if(t===this.allPlan.length-1&&(this.sortPlanByPlanValue(),0===this._planValue_total))return F.alert(f.JS.PC_ranking_alert2),void F.progress_close();if(t===this.allPlan.length&&(this._demandValue=this.original_demandValue.slice(),this._reAndcoValue_Norm_sum=[0,0,0,0,0,0,0,0],this._reAndcoValue_sum=[0,0,0,0,0,0,0,0],this._planValue_sum=0),t===2*this.allPlan.length){this._demandValue_0=this.original_demandValue.slice();for(var r=this._demandValue_0,o=0,s=0;s<8;++s){var l=ua(this._reAndcoValue_Norm_sum);if(0!==r[l]){o=this._reAndcoValue_sum[l]/r[l];break}this._reAndcoValue_Norm_sum[l]=0}0===o&&(this._demandValue_0=this.original_demandValue.slice());for(var d=0;d<8;++d)0!==r[d]&&0!==this._reAndcoValue_sum[d]&&(r[d]=((r[d]*o-this._reAndcoValue_sum[d])/this._reAndcoValue_sum[d]*.9+1)*r[d]);this._demandValue=this.original_demandValue.slice(),this._reAndcoValue_Norm_sum=[0,0,0,0,0,0,0,0],this._reAndcoValue_sum=[0,0,0,0,0,0,0,0],this._planValue_total=this._planValue_sum,this._planValue_sum=0}if(t>=this.allPlan.length&&t<3*this.allPlan.length){var _=t%this.allPlan.length,u=this.allPlan[_];if(this._planValue_sum+=u.planValue,t===2*this.allPlan.length?u.ranking(this._demandValue_0):u.ranking(this._demandValue),0!==u.planValue){for(var c=0;c<8;++c)this._reAndcoValue_Norm_sum[c]+=u.reAndcoValue_Norm[c],this._reAndcoValue_sum[c]+=u.reAndcoValue[c]*u.days;for(var m=this._planValue_sum/this._planValue_total,h=ua(this._reAndcoValue_Norm_sum),v=this._reAndcoValue_sum[h]/m,p=0;p<8;++p)this._demandValue[p]=this.original_demandValue[p]*v,this._demandValue[p]-=this._reAndcoValue_sum[p],this._demandValue[p]<0&&(this._demandValue[p]=0)}else t>=2*this.allPlan.length&&t<3*this.allPlan.length&&this._noPlan++}var g=100*(t+1)/this.allPlan.length/3+"%";if(F.progress_setWidth(g),t===3*this.allPlan.length-1){for(var T=0;T<this.plans_number;++T)this.allPlan[T].applyToLogisticsPlanData();qa._plansHasChanged();var b=f.JS.PC_ranking_done;0!==this._noPlan&&(b+=f.JS.PC_ranking_alert3_1+this._noPlan+f.JS.PC_ranking_alert3_2),F.alert(b),F.progress_close()}else setTimeout(function(){en.ranking(++t)},1)}},{key:"sortPlanByPlanValue",value:function(){this.allPlan.sort(nn)}}]),an);function an(e,t){_(this,an),this.original_demandValue=t,this.allPlan=[];var a=e.length;this.plans_number=a;for(var n=[0,0,0,0,0,0,0,0],i=0;i<a;++i){this.allPlan.push(new rn(e[i],t));for(var r=this.allPlan[i].reAndcoValue_Max,o=0;o<8;++o)n[o]=Math.max(n[o],r[o])}this.reAndcoValue_MaxMax=n;for(var s=0;s<a;++s)this.allPlan[s].resetReAndCoValueMax(this.reAndcoValue_MaxMax.slice())}function nn(e,t){return t.planValue-e.planValue}var rn=(e(on,[{key:"calcDays",value:function(){for(var e=this.LogisticsPlanData.timePeriod,t=0,a=0;a<e.length;++a)t=t+e[a][1]-e[a][0];return t}},{key:"resetReAndCoValueMax",value:function(e){this.reAndcoValue_Max=e}},{key:"ranking",value:function(e){var t=rt.creatTabBySaved(this.LogisticsPlanData.saved);t.setQValid();var a=new ta(t,8,48,38,e);a.ranking();for(var n=a.getStdznTargetValue("PlanCombination"),i=new Array(8),r=t.getCurrentValueMax(),o=0;o<8;o++)i[o]=Math.min(1,n[o]/r[o]),i[o]=Math.max(i[o],0);t.normalizedQValid();var s=new na(t,3,i);s.ranking();var l=s.getResult(),d=[];if(0!==l.length){for(var _=this.totalTime,u=0;u<8;++u)d.push(l[0][u+5]*_);this.missions=l[0].slice(1,5)}else d=[0,0,0,0,0,0,0,0],this.missions=[];this.reAndcoValue=d,this.reAndcoValue_Norm=this.normReAndCo(this.reAndcoValue),this.planValue=this.calcPlanValue(this.reAndcoValue_Norm)}},{key:"normReAndCo",value:function(e){for(var t=this.reAndcoValue_Max,a=[],n=this.days,i=0;i<8;++i)a.push(n*e[i]/t[i]);return a}},{key:"calcPlanValue",value:function(e){for(var t=0,a=0;a<8;++a)t+=e[a];return t}},{key:"applyToLogisticsPlanData",value:function(){this.LogisticsPlanData.saved.Missions=this.missions,this.LogisticsPlanData.reAndco=this.reAndcoValue}}]),on);function on(e,t){_(this,on),this.LogisticsPlanData=e;var a=rt.creatTabBySaved(e.saved);this.totalTime=a.getTotalTime(),a.setQValid(),this.reAndcoValue_Max=a.getCurrentValueMax(),this.original_demandValue=t,this.days=this.calcDays()}function sn(){document.getElementById("PlanCombinationSwitch").checked?(Se(),rt.cancelSelected(),it(),nt(),$("#plan_combination_card").removeClass("d-none"),$("#PlanCombination_addTimePeriod").removeClass("d-none"),$("#PC_addLogisticsPlan").removeClass("d-none"),$("#target").addClass("d-none"),$("#start_ranking").addClass("d-none"),$("#result_card").addClass("d-none"),$("#Logistics_setting_title").removeClass("d-none")):(un(),$("#plan_combination_card").addClass("d-none"),$("#PlanCombination_addTimePeriod").addClass("d-none"),$("#PC_addLogisticsPlan").addClass("d-none"),$("#PC_addConsumptionPlan").addClass("d-none"),$("#target").removeClass("d-none"),$("#start_ranking").removeClass("d-none"),$("#result_card").removeClass("d-none"),$("#Logistics_setting_title").addClass("d-none")),ja.resize_Timetable()}function ln(){$("#PlanCombination_startDate").attr("disabled","true"),$("#PlanCombination_endDate").attr("disabled","true")}function dn(){$("#PlanCombination_startDate").removeAttr("disabled"),$("#PlanCombination_endDate").removeAttr("disabled")}function _n(){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!0,$("#ConsumptionPlan_setting").removeClass("d-none"),$("#PC_addLogisticsPlan").addClass("d-none"),$("#PC_addConsumptionPlan").removeClass("d-none"),$("#plan_setting").addClass("d-none")}function un(){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!1,$("#ConsumptionPlan_setting").addClass("d-none"),$("#PC_addLogisticsPlan").removeClass("d-none"),$("#PC_addConsumptionPlan").addClass("d-none"),$("#plan_setting").removeClass("d-none")}var cn=[0,3e3,3200,3400,3600,3800,4e3,4200,4500,4700,5e3,5200,5500,5700,6e3,6300,6600,6900,7200,7500,7800,8100,8400,8700,9100,9400,9700,10100,10400,10800,11200,11500,11900,12300,12700,13100,13500,13900,14300,14700,15100,15500,16e3,16400,16900,17300,17800,18200,18700,19200,19600,20100,20600,21100,21600,22100,22600,23100,23600,24200,24700,25200,25800,26300,26900,27400,28e3,28600,29100,29700,30300,30900,31500,32100,32700,33300,33900,34600,35200,35800,36500,37100,37800,38400,39100,39700,40400,41100,41800,42500,43200,43900,44600,45300,46e3,46700,47400,48200,48900,49600,50400,51100,51900,52600,53400,54200,55e3,55700,56500,57300,58100,58900,59700,60600,61400,62200,63e3,63900,64700,65500,66400,67300,68100,69e3,69800,70700,71600,72500,73400,74300,75200,76100,77e3,77900,78800,79800,80700,81600,82600,83500,84500,85400,86400,87400,88400,89300,90300,91300,92300,93300,94300,95300,96300,97400,98400,99400,1e5];function mn(e){return 156<e?1e5+200*(e-156):cn[e]}function hn(e){if("LocalStorage"===e){var t=ha("Date");"noStorage"===t?(fa((new Date).toISOString().slice(0,10)),Ca(da((new Date).toISOString().slice(0,10),7))):(fa(t.start),Ca(t.end));var a=ha("current");"noStorage"!==a&&Fa(a);var n=ha("target");"noStorage"!==n&&Na(n);var i=ha("demand");"noStorage"!==i&&Ra(i);var r=ha("level");"noStorage"!==r&&Qa(r);var o=ha("ConsumptionSaved");"noStorage"!==o&&Wa.setSaved(o),qa.init(ha("LogisticsPlan")),Oa.init(ha("ConsumptionPlan"))}else{var s=e.date;fa(s.start),Ca(s.end),Fa(e.current),Na(e.target),Ra(e.demand),Qa(e.level);var l=e.ConsumptionSaved;Wa.setSaved(l),qa.init(e.LogisticsData),Oa.init(e.ConsumptionData)}ya(),Sa(),wa(),Da(),ja.print(qa.chartGetPlans(),Oa.chartGetPlans())}function vn(e){fa(e),ya(),wa(),Da(),Oa.changeDate(ba(),Pa()),qa.changeDate(ba(),Pa()),0===qa.chartGetPlans().length&&0===Oa.chartGetPlans().length&&dn(),ja.print(qa.chartGetPlans(),Oa.chartGetPlans())}function pn(e){var t=Pa();return""!==e&&e<t}function gn(e){return""===e?f.JS.PC_changeStart_prompt_3:Pa()<=e?f.JS.PC_changeStart_prompt_4:""}function Tn(e){Ca(e),ya(),wa(),Da(),Oa.changeDate(ba(),Pa()),qa.changeDate(ba(),Pa()),0===qa.chartGetPlans().length&&0===Oa.chartGetPlans().length&&dn(),ja.print(qa.chartGetPlans(),Oa.chartGetPlans())}function bn(e){var t=ba();return""!==e&&t<e}function fn(e){return""===e?f.JS.PC_changeEnd_prompt_3:e<=ba()?f.JS.PC_changeEnd_prompt_4:""}$("#PlanCombinationSwitch").on("click",function(){sn()});var yn=$("#PlanCombination_startDate");yn.on("input propertychange",function(){Sa(),wa(),Da(),Ja.clear()}),yn.on("blur",function(){ma("Date",{start:ba(!0),end:Pa()}),qa.reset(),Oa.reset(),ja.print()});var Pn=$("#PlanCombination_endDate");function Cn(){window.sha1&&window.md5&&window.LZString&&window.echarts&&window.html2canvas?function(){$("#Config_importInput").removeAttr("disabled"),$("#Config_importButton").removeAttr("disabled"),$("#Config_export").removeAttr("disabled"),$("#importSaved_input").removeAttr("disabled"),$("#importSaved_importButton").removeAttr("disabled"),""===document.createElement("a").download&&Promise&&$("#Capture").removeAttr("disabled");$("#page_loading").remove(),$("#PlanCombinationSwitch").removeAttr("disabled"),hn("LocalStorage"),window.PLAN_COMBINATION=!0}():setTimeout(Cn,100)}function loadBackupJS(){if(!window.sha1){var e=document.createElement("script");e.src="./dependent/js/sha1.min.js",document.body.appendChild(e)}if(!window.md5){var t=document.createElement("script");t.src="./dependent/js/md5.min.js",document.body.appendChild(t)}if(!window.LZString){var a=document.createElement("script");a.src="./dependent/js/lz-string.min.js",document.body.appendChild(a)}if(!window.echarts){var n=document.createElement("script");n.src="./dependent/js/echarts.min.js",document.body.appendChild(n)}if(!window.html2canvas){var i=document.createElement("script");i.src="./dependent/js/html2canvas.min.js",document.body.appendChild(i)}}Pn.on("input propertychange",function(){ya(),wa(),Da(),Ja.clear()}),Pn.on("blur",function(){var e=Pa(!0);ma("Date",{start:ba(),end:e}),qa.reset(),Oa.reset(),ja.print()}),$("#CommanderLevel").on("blur",function(){ma("level",Ba()),ja.print(qa.chartGetPlans(),Oa.chartGetPlans())}),$("#PlanCombination_planStartDate").on("blur",function(){ka(!0),Da()}),$("#PlanCombination_planEndDate").on("blur",function(){Aa(!0),wa()}),$("#PC_deleteAllPlans").on("click",function(){F.confirm(f.JS.PC_deleteAll_confirm,function(){qa.deleteAll(),Oa.deleteAll()})}),$("#LogisticsConsumptionPlanSwitch").on("click",function(){(document.getElementById("LogisticsConsumptionPlanSwitch").checked?_n:un)()}),$("#addNewTimePeriod").on("click",function(){Ja.add()}),$("#deleteAllTimePeriod").on("click",function(){Ja.clear()}),$("#PC_DateTimePeriod_body").on("click","button[id^=PC_TimePeriod_close_]",function(){var e="PC_TimePeriod_"+T(this.id);Ja.deleteThisRow(e)}),$("#PC_addLogisticsPlan").on("click",function(){qa.add()}),$("#PC_addConsumptionPlan").on("click",function(){Oa.add()}),$("#Consumption_add").on("click",function(){Oa.table_add()}),$("#consumption_saved").on("click","a[id^=consumption_saved_row_]",function(){Wa.click(parseInt(T(this.id)))}),$("#consumption_saved").on("click","button[id^=consumption_close_row_]",function(){Wa.delete(parseInt(T(this.id)))}),$("#consumption_saved_button").on("click",function(){Wa.save()}),$("#Consumption_reset").on("click",function(){$("#Consumption_select").val(0),Ia([0,0,0,0,0,0,0,0]),$a()}),$("#Consumption_tbody").on("click","button[id^=Consumption_table_close_row_]",function(){var e="Consumption_table_row_"+T(this.id);Oa._table_deleteThisRow(e)}),$("#Consumption_tbody").on("click","button[id^=Consumption_table_apply_row_]",function(){var e="Consumption_table_row_"+T(this.id);Oa.table_applyThisRow(e)}),$("#PC_startRanking").on("click",function(){var e;""+(e=La(!0))!="0,0,0,0,0,0,0,0"?0!==(en=new tn(qa.rankingGetPlans(),e)).allPlan.length?en.ranking():F.alert(f.JS.PC_ranking_add_alert):F.alert(f.JS.TargetValue0_alert)}),$("#PlanCombination_current_box").on("blur","input[id^=PC_current_]",function(){ja.print(qa.chartGetPlans(),Oa.chartGetPlans()),ma("current",Ea())}),$("#PlanCombination_current_box").on("focus","input[id^=PC_current_]",function(){this.select()}),$("#PlanCombination_demand_card").on("blur","input[id^=PC_target_]",function(){ma("target",Va())}),$("#PlanCombination_demand_card").on("focus","input[id^=PC_target_]",function(){this.select()}),$("#PlanCombination_demand_card").on("blur","input[id^=PC_demand_]",function(){ma("demand",La())}),$("#PlanCombination_demand_card").on("focus","input[id^=PC_demand_]",function(){this.select()}),$("#PC_calcDemand").on("click",function(){!function(){for(var e=Ea(!0),t=_a(ba(),Pa()),a=ja._calcReAndCoData(e,[],Oa.chartGetPlans(),t),n=[],i=a[0].length-1,r=Va(!0),o=0;o<8;++o){var s=a[o][i];s=Math.max(0,r[o]-s),n.push(s)}Ra(n)}()}),$("#PC_saveAll").on("click",function(){F.confirm(f.JS.PC_saveAll_confirm,function(){!function(){for(var e=qa._plans.length,t=0;t<e;++t)rt._saved.push(JSON.parse(JSON.stringify(qa._plans[t].saved))),rt._printLastSaved()}()})}),$("#Consumption_select").on("change",function(){Ia(Be[this.selectedIndex-1]),$("#Consumption_select").val(0)}),$("input[id^=Consumption_]").on("focus",function(){this.select()}),$("#PC_changeStartDate").on("click",function(){F.prompt(f.JS.PC_changeStart_prompt_1,f.JS.PC_changeStart_prompt_2,vn,function(){},"date",ba(),pn,function(e){return""},gn)}),$("#PC_changeEndDate").on("click",function(){F.prompt(f.JS.PC_changeEnd_prompt_1,f.JS.PC_changeEnd_prompt_2,Tn,function(){},"date",Pa(),bn,function(e){return""},fn)}),window.onload=function(){if($("#Notransition").remove(),!window.GF_OFFLINE_VERSION){var e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/js-sha1@0.6.0/src/sha1.min.js",document.body.appendChild(e);var t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js",document.body.appendChild(t);var a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js",a.integrity="sha256-nRoO8HoupfqozUr7YKBRgHXmdx40Hl/04OSBzv7e7L8=",a.crossOrigin="anonymous",document.body.appendChild(a);var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/echarts@4.7.0/dist/echarts.min.js",n.integrity="sha256-eKrx6Ly6b0Rscx/PSm52rJsvK76RJyv18Toswq+OLSs=",n.crossOrigin="anonymous",document.body.appendChild(n);var i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.1/dist/html2canvas.min.js",i.integrity="sha256-uacRffSSMP9qpvNWhVmYLykBv9YKMA1d/VSIN1AmfyQ=",i.crossOrigin="anonymous",document.body.appendChild(i)}Cn(),window.GF_OFFLINE_VERSION?setTimeout(loadBackupJS,1):setTimeout(loadBackupJS,6e3)},$("#start_ranking").removeAttr("disabled");