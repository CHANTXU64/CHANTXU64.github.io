/** copyright info
 * [GF_logistics]{@link https://github.com/CHANTXU64/Girls-Frontline}
 *
 * @namespace GF_logistics
 * @version 1.2.0-rc1
 * @author ChantXu64 [chantxu@outlook.com]
 * @copyright ChantXu64
 * @license MIT
 */
window.ResultsPlan_JS=!0;var qt=(e(zt,null,[{key:"clear",value:function(){this._lastResultsPlan=[],this._lastSortBy="Ranking"}},{key:"getLastResultsPlan",value:function(){return this._lastResultsPlan}},{key:"getLastSortBy",value:function(){return this._lastSortBy}},{key:"print",value:function(e,t){var a=0<arguments.length&&void 0!==e?e:this._lastResultsPlan,n=1<arguments.length&&void 0!==t?t:this._lastSortBy;if(document.getElementById("start_ranking_html").style.display="none",0===a.length)document.getElementById("Plan_Table").innerHTML=v.JS.NoPlan,this.clear();else{var i=0,r=document.getElementById("result_plan_table");null!==r&&(i=r.scrollLeft);var l=this.sortResultPlan(a,n);document.getElementById("Plan_Table").innerHTML=this._getPrintHtml(l),0!=i&&(document.getElementById("result_plan_table").scrollLeft=i),this._lastResultsPlan=l,this._lastSortBy=n}}},{key:"sortResultPlan",value:function(e,t){var a=e.slice();switch(t){case"Ranking":h(a,0);break;case"Manp":c(a,5);break;case"Ammu":c(a,6);break;case"Rati":c(a,7);break;case"Part":c(a,8);break;case"TPro":c(a,9);break;case"Equi":c(a,10);break;case"QPro":c(a,11);break;case"QRes":c(a,12)}return a}},{key:"_getPrintHtml",value:function(e){var t="";t+='<div class="table-responsive" id="result_plan_table" style="margin-bottom: 0;">',t+='<table class="table table-striped table-hover text-nowrap result-table" style="margin-bottom: 0; text-align: center; border: 0; font-size: 14px;">';var a=$e();t+=a.printPlanTableTitle()+"<tbody>";var n=60;ee()||(n=a.getTotalTime(!1));for(var i=0;i<e.length;i++){t+="<tr tabindex='0' id='print_result_plan_tr_"+i+"'>";for(var r=0;r<4;r++)t+="<td style='width: 5%;'>",t+=""+e[i][r+1],t+="</td>";for(var l=4;l<8;l++)t+="<td style='width:"+a.PlanTableResourceAndContractWidth+"'>",t+=""+Math.round(e[i][l+1]*n*10)/10,t+="</td>";for(var o=8;o<12;o++)t+="<td style='width:"+a.PlanTableResourceAndContractWidth+";'>",t+=""+Math.round(e[i][o+1]*n*100)/100,t+="</td>";for(var s=e[0].length,d=13;d<s;d++)t+="<td style='width:"+a.PlanTableResourceAndContractWidth+";'>",t+=e[i][d],t+="</td>";t+="</tr>"}return t+="</tbody>"}}]),zt);function zt(){u(this,zt)}qt._lastResultsPlan=[],qt._lastSortBy,window.FineTuning_JS=!0;var Ut=(e(jt,null,[{key:"clear",value:function(){this._TargetValue_Original=[0,0,0,0,0,0,0,0],this._TargetValue=[0,0,0,0,0,0,0,0],this._ShownTab=-1}},{key:"setFineTuning",value:function(e,t){this._TargetValue_Original=e.slice(),this._TargetValue=e.slice(),this._ShownTab=t}},{key:"getTargetValue",value:function(){return this._TargetValue.slice()}},{key:"getShownTab",value:function(){return this._ShownTab}},{key:"changeTargetValue",value:function(e,t){var a=["MT","AT","RT","PT","TT","ET","QPT","QRT"].indexOf(t);-1===e?this._TargetValue[a]-=this._TargetValue_Original[a]/50:this._TargetValue[a]+=this._TargetValue_Original[a]/50}},{key:"print",value:function(){if(Ye()){var e=document.getElementById("FineTuning"),t=["MT","AT","RT","PT","TT","ET","QPT","QRT"];if(""===e.innerHTML){var a=v.JS,n=[a.FineTuningManp,a.FineTuningAmmu,a.FineTuningRati,a.FineTuningPart,a.FineTuningTPro,a.FineTuningEqui,a.FineTuningQPro,a.FineTuningQRes],i='<div class="card" style="margin-bottom:5px">';i+='<div class="card-header">',i+='<a data-toggle="collapse" id="FineTuningTool_panelTitle" href="#FineTuningTool" class="collapsed">'+a.FineTuningTool+"</a></div>",i+='<div id="FineTuningTool" class="collapse"',x()&&(i+='style="transition: none;"'),i+=">",i+='<div class="card-body row" style="padding: 10px 5px; margin: 0; text-aligh: center;">';for(var r=0;r<8;r++){0===r&&(i+='<div class="col-lg-6 col-md-6 col-sm-6" style="padding-left: 5px; padding-right: 5px;">'),4===r&&(i+='</div> <div class="col-lg-6 col-md-6 col-sm-6" style="padding-left: 5px; padding-right: 5px;">'),i+='<div class="input-group" style="margin-bottom: 10px; width: 100%;">',i+='<span class="input-group-text input-group-span FineTuning-span" style="font-size: 14px;" id="FineTuningTool_'+t[r]+'">'+n[r]+"</span>",i+='<button class="btn btn-outline-dark input-group-btn btn-bolder FineTuning-button" style="display:block;" type="button" id="FineTuning_minus_'+t[r]+'"';var l=this._TargetValue_Original[r],o=this._TargetValue[r];(0===l||o-l/50<=0||o-l/50<.9*l)&&(i+='disabled="disabled"'),i+='title="'+v.HTMLJS.FineTuning_minus+'">-</button>',i+='<button class="btn btn-outline-dark input-group-btn btn-bolder FineTuning-button" style="display: block;" type="button" id="FineTuning_plus_'+t[r]+'"',(0===l||1<=o+l/50||1.14*l<o+l/50)&&(i+='disabled="disabled"'),i+='title="'+v.HTMLJS.FineTuning_plus+'">+</button>',i+="</div>"}i+="</div></div></div></div>",e.innerHTML=i}else for(var s=0;s<8;s++){var d=this._TargetValue_Original[s],u=this._TargetValue[s];if(0===d||u-d/50<=0||u-d/50<.8*d){var _=$("#FineTuning_minus_"+t[s]);"disabled"!==_.attr("disabled")&&_.attr("disabled","disabled")}else{var c=$("#FineTuning_minus_"+t[s]);"disabled"===c.attr("disabled")&&c.removeAttr("disabled")}if(0===d||1<=u+d/50||1.2*d<u+d/50){var m=$("#FineTuning_plus_"+t[s]);"disabled"!==m.attr("disabled")&&m.attr("disabled","disabled")}else{var h=$("#FineTuning_plus_"+t[s]);"disabled"===h.attr("disabled")&&h.removeAttr("disabled")}}}}}]),jt);function jt(){u(this,jt)}Ut._TargetValue_Original=[],Ut._TargetValue=[],Ut._ShownTab=-1;var Yt=(e(Xt,[{key:"_setList",value:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]=new Array(13);return t}},{key:"ranking",value:function(){for(var e=this.ShownTab.getQValidLength(),t=e-3,a=e-2,n=e-1,i=e,r=0;r<t;++r)for(var l=r+1;l<a;++l)for(var o=l+1;o<n;++o)for(var s=o+1;s<i;++s)this._calculateAndPushIntoList(r,l,o,s)}},{key:"_pushIntoList",value:function(e,t,a,n,i,r){0 in this.List[this.List_lastIndex]?this._push(e,t,a,n,i,r):this._pushIntoFirstEmpty(e,t,a,n,i,r)}},{key:"_pushIntoFirstEmpty",value:function(e,t,a,n,i,r){for(var l=this.List_lastIndex;0!==l&&!(0 in this.List[l-1]);)l--;this._pushIntoThisRow(l,e,t,a,n,i,r),this._sortList(l,i)}},{key:"_push",value:function(e,t,a,n,i,r){var l=this.List_lastIndex;i<=this.List[l][12]||(this._pushIntoThisRow(l,e,t,a,n,i,r),this._sortList(l,i))}},{key:"_pushIntoThisRow",value:function(e,t,a,n,i,r,l){this.List[e]=[t,a,n,i,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],r]}},{key:"_sortList",value:function(e,t){for(var a=e-1;0<=a&&t>this.List[a][12];a--){var n=[this.List[a],this.List[a+1]];this.List[a+1]=n[0],this.List[a]=n[1]}}}]),Xt);function Xt(e,t){u(this,Xt),this.List=this._setList(t),this.List_length=t,this.List_lastIndex=t-1,this.ShownTab=e}var Zt=(t(Kt,Yt),e(Kt,[{key:"_correctTargetValueHTML",value:function(){var e=se(),t=e.slice(0,4),a=e.slice(4,8);return t=this._correctTargetValueHTML_main(t),a=this._correctTargetValueHTML_main(a),de(e=t.concat(a)),e}},{key:"_correctTargetValueHTML_main",value:function(e){for(var t=w(e),a=Math.round(t/5e3*100)/100,n=0;n<4;n++)0!==e[n]&&(e[n]=Math.max(a,e[n]));return e}},{key:"_correctTargetValue",value:function(){var e=this._correctResourceValue(),t=this._correctContractValue(),a=e.concat(t);if(""+a=="0,0,0,0,0,0,0,0")throw V.alert(v.JS.TargetValue0_alert),"Warning: TargetValue cannot all be 0!";return a}},{key:"_correctResourceValue",value:function(){var e=this.targetValue_html.slice(0,4),t=100-_e();return this._valuesNotAll0(e)&&this._correctValue(e,t),e}},{key:"_correctContractValue",value:function(){var e=this.targetValue_html.slice(4,8),t=_e();return this._valuesNotAll0(e)&&this._correctValue(e,t),e}},{key:"_valuesNotAll0",value:function(e){for(var t=0;t<e.length;t++)if(0!==e[t])return!0;return!1}},{key:"_correctValue",value:function(e,t){for(var a=t/w(e),n=0;n<e.length;n++)e[n]*=a}},{key:"_getNorm",value:function(e){for(var t=0,a=0;a<8;a++)t+=Math.pow(e[a],2);return Math.pow(t,.5)}},{key:"ranking",value:function(){this.ShownTab.deleteUselessMissions(this.QValidMaxLength_1,this.targetValue),s(Kt.prototype.__proto__||Object.getPrototypeOf(Kt.prototype),"ranking",this).call(this),this.ShownTab.getQValidLength()>this.QValidMaxLength_2&&this.ShownTab.deleteUselessMissions(this.QValidMaxLength_2,this.targetValue,this.Qvalid_missionValue)}},{key:"_calculateAndPushIntoList_andCalculateMissionsValue",value:function(e,t,a,n){var i=this.ShownTab.calculateCurrentValue(e,t,a,n);if(-1!==i[0]){var r=this._calculateValue(i),l=this.Qvalid_missionValue;l[e]+=r,l[t]+=r,l[a]+=r,l[n]+=r,this._pushIntoList(e,t,a,n,r,i)}}},{key:"_calculateAndPushIntoList_normal",value:function(e,t,a,n){var i=this.ShownTab.calculateCurrentValue(e,t,a,n);if(-1!==i[0]){var r=this._calculateValue(i);this._pushIntoList(e,t,a,n,r,i)}}},{key:"_calculateValue",value:function(e){var t=this.targetValue,a=[0,0,0,0,0,0,0,0];0!==t[0]&&(a[0]=e[0]),0!==t[1]&&(a[1]=e[1]),0!==t[2]&&(a[2]=e[2]),0!==t[3]&&(a[3]=e[3]),0!==t[4]&&(a[4]=500*e[4]),0!==t[5]&&(a[5]=500*e[5]),0!==t[6]&&(a[6]=500*e[6]),0!==t[7]&&(a[7]=500*e[7]);var n=this._getNorm(a);if(0===n)return 0;var i=this._getDotProduct(a,t)/this._norm_target,r=i/n,l=(-.698131700797732*r*r-.872664625997164)*r+1.57079632679489,o=1-.5*(0<l?l:0);return o*o*i}},{key:"_getDotProduct",value:function(e,t){for(var a=0,n=0;n<8;n++)a+=e[n]*t[n];return a}},{key:"getStdznTargetValue",value:function(e){var t=this._getAvgCurrentByList(),a=t.slice(0,4);a.class="Resource";var n=t.slice(4,8);n.class="Contract";var i=this._getCalibration(a),r=void 0;r="PlanCombination"===e&&0!==i?i*=.8:this._getCalibration(n);for(var l=0;l<4;l++)t[l]=0!==i?this.targetValue_html[l]/i:0;for(var o=4;o<8;o++)t[o]=0!==r?this.targetValue_html[o]/r:0;return t}},{key:"_getAvgCurrentByList",value:function(){var e=[0,0,0,0,0,0,0,0],t=new Array(8),a=this.List;t.fill(this.List_length);for(var n=0;n<8;n++)for(var i=0;i<this.List_length;i++)e[n]+=a[i][n+4],0===a[i][n+4]&&t[n]--;for(var r=0;r<8;r++)0===t[r]?e[r]=0:e[r]/=t[r];return e}},{key:"_getCalibration",value:function(e){for(var t=this._getTarget0Html(e.class),a=this._getCurrent0Max(e.class),n=0,i=e.length,r=0;r<e.length;r++)0!==e[r]?(n+=t[r]/e[r],0===t[r]&&i--):i--;if(0!==n)n/=i;else{for(var l=0,o=e.length,s=0;s<e.length;s++)0!==a[s]?l+=a[s]:o--;0===o?l=0:l/=o,n=w(t)/l}return n}},{key:"_getTarget0Html",value:function(e){return new Array(4),"Resource"===e?this.targetValue_html.slice(0,4):this.targetValue_html.slice(4,8)}},{key:"_getCurrent0Max",value:function(e){return new Array(4),"Resource"===e?this.ShownTab.getCurrentValueMax().slice(0,4):this.ShownTab.getCurrentValueMax().slice(4,8)}}]),Kt);function Kt(e,t,a,n,i){u(this,Kt);var r=d(this,(Kt.__proto__||Object.getPrototypeOf(Kt)).call(this,e,t)),l=r.ShownTab.getQValidLength();if(r.QValidMaxLength_1=Math.min(a,l),r.QValidMaxLength_2=Math.min(n,l),n<l){r._calculateAndPushIntoList=r._calculateAndPushIntoList_andCalculateMissionsValue;var o=new Array(r.QValidMaxLength_1);o.fill(0),r.Qvalid_missionValue=o}else r._calculateAndPushIntoList=r._calculateAndPushIntoList_normal;return i?(r.targetValue_html=i,r.targetValue=i):(r.targetValue_html=r._correctTargetValueHTML(),r.targetValue=r._correctTargetValue()),r._norm_target=r._getNorm(r.targetValue),r}var ea=(t(ta,Yt),e(ta,[{key:"_calculateAndPushIntoList",value:function(e,t,a,n){var i=this.ShownTab.calculateCurrentValue(e,t,a,n);if(-1!==i[0]){for(var r=0;r<8;r++)if(i[r]<this.targetValue_half[r])return;var l=this._calculateValue(i);this._pushIntoList(e,t,a,n,l,i)}}},{key:"_calculateValue",value:function(e){for(var t=0,a=99999999999,n=this.targetValue,i=0;i<8;i++)0!==n[i]&&(a=Math.min(a,e[i]/n[i]));for(var r=0;r<8;r++)t+=this._calculateValue_main(n[r],e[r],a);return t}},{key:"_calculateValue_main",value:function(e,t,a){return 0===e?0:.5*(Math.min(t,e)+Math.min(t,1.5*e*a))}},{key:"getResult",value:function(){for(var e=this.ShownTab,t=e.getQValid(!0),a=e.getCurrentValueMax(),n=[],i=0;i<this.List_length;i++){var r=this.List[i];if(!(0 in r))break;var l=[];l.push(i);for(var o=new Array(4),s=0;s<4;s++)o[s]=t[r[s]][0];o=o.sort(M);for(var d=0;d<4;d++)l.push(o[d]);for(var u=0;u<8;u++)l.push(r[u+4]*a[u]);for(var _=this.ShownTab.printTableCustomize(r[0],r[1],r[2],r[3]),c=0;c<_.length;c++)l.push(_[c]);n.push(l)}return n}},{key:"print",value:function(e){var t=0<arguments.length&&void 0!==e?e:"Ranking";We(this.getResult(),t)}}]),ta);function ta(e,t,a){u(this,ta);var n=d(this,(ta.__proto__||Object.getPrototypeOf(ta)).call(this,e,t));n.targetValue=a,n.targetValue_half=n.targetValue.slice();for(var i=0;i<8;i++)n.targetValue_half[i]=.5*n.targetValue_half[i];return n}var aa=44,na=34;function ia(){var e=$e();e.setQValid();var t=new Zt(e,8,aa,na);t.ranking();for(var a=t.getStdznTargetValue(),n=new Array(8),i=e.getCurrentValueMax(),r=0;r<8;r++)n[r]=Math.min(1,a[r]/i[r]),n[r]=Math.max(n[r],0);e.normalizedQValid(),Ut.setFineTuning(n,e);var l=new ea(e,16,n);l.ranking(),l.print(),"none"!==document.getElementById("start_ranking").style.display&&($("#Time_Anytime_hours").attr("disabled","true"),$("#Time_Anytime_minutes").attr("disabled","true"),$("#Tab_Anytime_MinimumIntervalTime_minutes").attr("disabled","true"),$("#Time_Timetable_hours").attr("disabled","true"),$("#Time_Timetable_minutes").attr("disabled","true"),$("#tab_Timetable_deleteall").attr("disabled","true"),$("button[id^=Tab_Timetable_range_thumb_]").attr("disabled","true"),$("#Tab_Timetable_new_hours").attr("disabled","true"),$("#Tab_Timetable_new_minutes").attr("disabled","true"),$("#Tab_Timetable_AddNewTimePoint").attr("disabled","true"),$("#GreatSuccessRate").attr("disabled","true"),$("#GreatSuccessRateUp_btn").attr("disabled","true"),$("#GreatSuccessRateUp_btn").addClass("disabled"),$("#ChapterLimit").attr("disabled","true"),$("#ContractWeight").attr("disabled","true"),$("button[id^=setTarget_]").attr("disabled","true"),$("#MT").attr("disabled","true"),$("#AT").attr("disabled","true"),$("#RT").attr("disabled","true"),$("#PT").attr("disabled","true"),$("#TT").attr("disabled","true"),$("#ET").attr("disabled","true"),$("#QPT").attr("disabled","true"),$("#QRT").attr("disabled","true"),$("button[id^=Target_minus_]").attr("disabled","true"),$("button[id^=Target_plus_]").attr("disabled","true"),document.getElementById("start_ranking").style.display="none",document.getElementById("clear_ranking").style.display="")}function ra(e,t){Ut.changeTargetValue(e,t);var a=Ut.getShownTab(),n=Ut.getTargetValue(),i=new ea(a,16,n);i.ranking(),i.print(qt.getLastSortBy())}function la(e,t){var a=new Date(e);a.setDate(a.getDate()+t);var n=a.getMonth()+1;(n+"").length<2&&(n="0"+n);var i=a.getDate();return(i+"").length<2&&(i="0"+i),a.getFullYear()+"-"+n+"-"+i}function oa(e,t){var a=new Date(e);return(new Date(t)-a)/864e5}function sa(e){for(var t=e[0],a=0,n=e.length,i=0;i<n;i++)t<e[i]&&(t=e[i],a=i);return a}var da="GF_Logistics_PC_v"+B.slice(0,B.indexOf("."))+".x.x";function ua(e,t){if(N){var a=localStorage.getItem(da);try{a=JSON.parse(a)}catch(e){console.error("storageGetItem, storage: "+a),a={}}null===a&&(a={}),a[e]=t,a.version=B,a=JSON.stringify(a),localStorage.setItem(da,a)}}function _a(e){if(N){var t=localStorage.getItem(da);if(null===t)return"noStorage";try{t=JSON.parse(t)}catch(e){console.error("storageGetItem, storage: "+t),t={}}var a=t[e];return void 0===a?"noStorage":a}return"noStorage"}var ca=document.getElementById("PlanCombination_planStartDate"),ma=document.getElementById("PlanCombination_planEndDate"),ha=document.getElementById("PlanCombination_startDate"),va=document.getElementById("PlanCombination_endDate");function ga(e){var t=0<arguments.length&&void 0!==e&&e,a=ha,n=a.value,i=a.getAttribute("min"),r=a.getAttribute("max");return(""===n||n<i||r<n)&&(n=(new Date).toISOString().slice(0,10),t&&(a.value=n)),n}function pa(e){ua("Date",{start:ha.value=e,end:Ta()})}function ba(){var e=ha,t=la(Ta(),-1);e.setAttribute("max",t)}function Ta(e){var t=0<arguments.length&&void 0!==e&&e,a=va,n=a.value,i=a.getAttribute("min"),r=a.getAttribute("max");return(""===n||n<i||r<n)&&(n=la((new Date).toISOString().slice(0,10),7),t&&(a.value=n)),n}function fa(e){va.value=e,ua("Date",{start:ga(),end:e})}function ya(){var e=va,t=la(ga(),1);e.setAttribute("min",t)}function Pa(e){var t=0<arguments.length&&void 0!==e&&e,a=ca,n=a.value,i=ga(),r=la(Ta(),-1);return new Date(n)<new Date(i)||new Date(n)>new Date(r)?(t&&(a.value=""),"error"):n}function Ca(){var e=ca,t=ga();e.setAttribute("min",t);var a=void 0,n=Sa();a=la(""!==n?n:Ta(),-1),e.setAttribute("max",a)}function Sa(e){var t=0<arguments.length&&void 0!==e&&e,a=ma,n=a.value,i=la(ga(),1),r=Ta();return new Date(n)<new Date(i)||new Date(n)>new Date(r)?(t&&(a.value=""),"error"):n}function ka(){var e=ma,t=Ta();e.setAttribute("max",t);var a=void 0,n=Pa();a=la(""!==n?n:ga(),1),e.setAttribute("min",a)}function wa(e){for(var t=0<arguments.length&&void 0!==e?e:["","","","","","","",""],a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=0;n<8;++n)$("#Consumption_"+a[n]).val(t[n])}function Aa(e){for(var t=0<arguments.length&&void 0!==e&&e,a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=[],i=0;i<8;++i)n.push(P($("#PC_demand_"+a[i]),t));return n}function Ma(e){for(var t=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],a=0;a<8;++a)$("#PC_demand_"+t[a]).val(e[a]);ua("demand",e)}function xa(e){for(var t=0<arguments.length&&void 0!==e&&e,a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=[],i=0;i<8;++i)n.push(P($("#PC_current_"+a[i]),t)),i<4&&3e5<n[i]&&(n[i]=3e5,t&&$("#PC_current_"+a[i]).val(n[i]));return n}function Da(e){for(var t=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],a=0;a<8;++a)$("#PC_current_"+t[a]).val(e[a]);ua("current",e)}function $a(e){for(var t=0<arguments.length&&void 0!==e&&e,a=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],n=[],i=0;i<8;++i)n.push(P($("#PC_target_"+a[i]),t)),i<4&&3e5<n[i]&&(n[i]=3e5,t&&$("#PC_target_"+a[i]).val(n[i]));return n}function Ia(e){for(var t=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],a=0;a<8;++a)$("#PC_target_"+t[a]).val(e[a]);ua("target",e)}function La(e){if(""===$("#CommanderLevel").val())return-1;var t=C($("#CommanderLevel"));return t=Math.max(1,t),e&&t!=$("#CommanderLevel").val()&&$("#CommanderLevel").val(t),t}function Ra(e){-1===e?$("#CommanderLevel").val(""):$("#CommanderLevel").val(e)}var Ea=(e(Fa,null,[{key:"add",value:function(){var e=Pa(!0),t=Sa(!0);if(""!==e&&""!==t)if("error"!==e&&"error"!==t){var a=this._getATimePeriodHTML(e,t,this._number++);this._timePeriod.push([e,t]),$("#PC_DateTimePeriod_body").append(a)}else V.alert(v.JS.PCTimeAlert2);else V.alert(v.JS.PCTimeAlert1)}},{key:"_getATimePeriodHTML",value:function(e,t,a){var n="";return n+='<code class="list-group-item p-2" id="PC_TimePeriod_'+a+'">',n+=e+" ~ "+t+'<button class="close" title="'+v.JS.delete_+'" id="PC_TimePeriod_close_'+a+'">×</button></code>'}},{key:"deleteThisRow",value:function(e){for(var t=document.getElementById(e),a=0;;){if($("#PC_DateTimePeriod_body").children()[a].id===e){document.getElementById("PC_DateTimePeriod_body").removeChild(t);break}++a}this._timePeriod.splice(a,1)}},{key:"clear",value:function(){var e=this._timePeriod;return this._timePeriod=[],this._number=0,$("#PC_DateTimePeriod_body").html(""),ca.value="",ma.value="",Ca(),ka(),e}},{key:"getTimePeriod",value:function(){for(var e=[],t=this._timePeriod.length,a=0;a<t;++a)e.push(this._timePeriod[a].slice());return e.slice()}},{key:"setTimePeriod",value:function(e){this.clear();for(var t=e.length,a=ga(),n=0;n<t;++n){var i=la(a,e[n][0]),r=la(a,e[n][1]);this._timePeriod.push([i,r]);var l=this._getATimePeriodHTML(i,r,this._number++);$("#PC_DateTimePeriod_body").append(l)}}}]),Fa);function Fa(){u(this,Fa)}Ea._timePeriod=[],Ea._number=0;var Va=(e(Qa,null,[{key:"init",value:function(e){if(this._table_clear(),"noStorage"!==e&&void 0!==e)this._startDate=e.startDate,this._endDate=e.endDate,this._totalDays=e.totalDays,this._planFlag=e.planFlag,this._plans=e.plans,this._plansNumber=e.plansNumber,0!==this._plans.length&&Ka();else{var t=ga(),a=Ta(),n=oa(this._startDate=t,this._endDate=a);0<n&&(this._totalDays=n,this._planFlag=new Array(n),this._planFlag.fill(0)),this._plans=[],this._plansNumber=0}this.setStorage()}},{key:"reset",value:function(){var e=ga(),t=Ta();this._startDate=e,this._endDate=t,this._plans=[],this._table_clear(),this._plansNumber=0,this._tableNumber=0;var a=oa(e,t);0<a&&(this._totalDays=a,this._planFlag=new Array(a),this._planFlag.fill(0))}},{key:"setStorage",value:function(){ua("ConsumptionPlan",this.exportData())}},{key:"exportData",value:function(){var e={};return e.startDate=this._startDate,e.endDate=this._endDate,e.totalDays=this._totalDays,e.planFlag=this._planFlag,e.plans=this._plans,e.plansNumber=this._plansNumber,e}},{key:"table_add",value:function(){var e=function(){for(var e=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],t=[],a=0;a<8;++a){var n=S($("#Consumption_"+e[a]));t.push(n)}return t}(),t=P($("#Consumption_times")),a=this._table_getHTML(e,t);$("#Consumption_tbody").append(a);for(var n=this._tableData,i=0;i<8;++i)e[i]*=t,n[0][i]+=e[i];e.push(t),n.push(e),this._table_printTotal(this._tableData[0])}},{key:"_table_getHTML",value:function(e,t){for(var a=this._tableNumber++,n='<tr id="Consumption_table_row_'+a+'">',i=0;i<8;++i)n+="<td>",0<e[i]&&(n+="+"),n+=T(e[i])+"</td>";return n+="<td>"+t,n+='<button id="Consumption_table_close_row_'+a+'" class="close" title="'+v.JS.delete_+'">×</button></td>'}},{key:"_table_deleteThisRow",value:function(e){for(var t=document.getElementById(e),a=0;;){if($("#Consumption_tbody").children()[a].id===e){document.getElementById("Consumption_tbody").removeChild(t);break}++a}for(var n=this._tableData[a+1],i=0;i<8;++i)this._tableData[0][i]-=n[i];this._table_printTotal(this._tableData[0]),this._tableData.splice(a+1,1)}},{key:"_table_clear",value:function(){this._tableData=[[0,0,0,0,0,0,0,0]],this._tableNumber=0,document.getElementById("Consumption_tbody").innerHTML="",this._table_printTotal(this._tableData[0])}},{key:"_table_printTotal",value:function(e){for(var t="<tr>",a=0;a<8;++a)t+="<td>",0<e[a]&&(t+="+"),t+=T(e[a])+"</td>";t+="</tr>",document.getElementById("Consumption_total").innerHTML=t}},{key:"add",value:function(){var e=Ea.getTimePeriod(),t=e.length;if(0!==t)if(32<=this._plans.length)V.alert(v.JS.PC_L_alert3);else{for(var a=this._planFlag.slice(),n=0;n<t;++n){e[n][0]=oa(this._startDate,e[n][0]),e[n][1]=oa(this._startDate,e[n][1]);for(var i=e[n][0],r=e[n][1],l=i;l<r;++l)if(++this._planFlag[l],1<this._planFlag[l]){this._planFlag=a;var o=la(this._startDate,l);return void V.alert(v.JS.PC_C_alert2_1+o+v.JS.PC_C_alert2_2)}}for(var s=[240],d=0;d<t;++d)s.push(e[d][0]),s.push(1680),s.push(e[d][1]-e[d][0]);var u={};u.timePeriod=e,u.number=this._plansNumber++,u.reAndco=this._tableData[0].slice(),u.TimetableData=s,u.tableData=this._tableData.slice(),this._plans.push(u),Ea.clear(),Ka(),this._plansHasChanged()}else V.alert(v.JS.PC_L_alert1)}},{key:"apply",value:function(e){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!0,tn(),this._table_clear();for(var t=0;this._plans[t].number!==e;)++t;Ea.setTimePeriod(this._plans[t].timePeriod);var a=[];void 0===this._plans[t].tableData?(a.push(this._plans[t].reAndco.slice()),a.push(this._plans[t].reAndco.slice()),a[1].push(1)):a=this._plans[t].tableData;for(var n=1;n<a.length;++n){var i=a[n],r=this._table_getHTML([i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]],i[8]);$("#Consumption_tbody").append(r)}this._table_printTotal(this._plans[t].reAndco),this._tableData=[];for(var l=0;l<a.length;++l)this._tableData.push(a[l].slice())}},{key:"deleteAll",value:function(){this.reset(),en(),this._plansHasChanged()}},{key:"deleteThis",value:function(e){for(var t=0;this._plans[t].number!==e;)++t;for(var a=this._plans[t].timePeriod.length,n=0;n<a;++n)for(var i=this._plans[t].timePeriod[n][0],r=this._plans[t].timePeriod[n][1],l=i;l<r;++l)this._planFlag[l]=0;this._plans.splice(t,1),this._plansHasChanged(),0===this._plans.length&&0===Ba._plans.length&&en()}},{key:"_plansHasChanged",value:function(){Ha.printFromConsumptionPlan(this._plans),this.setStorage()}},{key:"chartGetPlans",value:function(){return this._plans}}]),Qa);function Qa(){u(this,Qa)}Va._plans=[],Va._plansNumber=0,Va._startDate="",Va._endDate="",Va._totalDays=0,Va._planFlag=[],Va._tableNumber=0,Va._tableData=[[0,0,0,0,0,0,0,0]];var Ba=(e(Na,null,[{key:"init",value:function(e){if("noStorage"!==e&&void 0!==e)this._startDate=e.startDate,this._endDate=e.endDate,this._totalDays=e.totalDays,this._totalTimePerDay=e.totalTimePerDay,this._plans=e.plans,this._plansNumber=e.plansNumber,0!==this._plans.length&&Ka();else{var t=ga(),a=Ta(),n=oa(this._startDate=t,this._endDate=a);0<n&&(this._totalDays=n,this._totalTimePerDay=new Array(n),this._totalTimePerDay.fill(0)),this._plans=[],this._plansNumber=0}this.setStorage()}},{key:"reset",value:function(){var e=ga(),t=Ta();this._startDate=e,this._endDate=t,this._plans=[],this._plansNumber=0;var a=oa(e,t);0<a&&(this._totalDays=a,this._totalTimePerDay=new Array(a),this._totalTimePerDay.fill(0)),this.setStorage()}},{key:"setStorage",value:function(){ua("LogisticsPlan",this.exportData())}},{key:"exportData",value:function(){var e={};return e.startDate=this._startDate,e.endDate=this._endDate,e.totalDays=this._totalDays,e.totalTimePerDay=this._totalTimePerDay,e.plans=this._plans,e.plansNumber=this._plansNumber,e}},{key:"add",value:function(){var e=Ea.getTimePeriod(),t=e.length;if(0!==t)if(32<=this._plans.length)V.alert(v.JS.PC_L_alert3);else{for(var a="",n=0;n<t;++n)a+=e[n][0].slice(5)+"~"+e[n][1].slice(5)+", ",e[n][0]=oa(this._startDate,e[n][0]),e[n][1]=oa(this._startDate,e[n][1]);a=a.slice(0,-2);for(var i=$e().getTotalTime(),r=this._totalTimePerDay.slice(),l=0;l<t;++l)for(var o=e[l][0],s=e[l][1],d=o;d<s;++d)if(this._totalTimePerDay[d]+=i,1440<this._totalTimePerDay[d]){this._totalTimePerDay=r;var u=la(this._startDate,d);return void V.alert(v.JS.PC_L_alert2_1+u+v.JS.PC_L_alert2_2)}var _=it.getSavedDataFromPage(a),c={};c.timePeriod=e,c.saved=_,c.time=i,c.number=this._plansNumber++,c.reAndco=it.getReAndCoBySaved(c.saved,!1),this._plans.push(c),Ea.clear(),Ka(),this._plansHasChanged()}else V.alert(v.JS.PC_L_alert1)}},{key:"apply",value:function(e){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!1,an();for(var t=0;this._plans[t].number!==e;)++t;it.apply(this._plans[t].saved),Ea.setTimePeriod(this._plans[t].timePeriod)}},{key:"deleteAll",value:function(){this.reset(),en(),this._plansHasChanged()}},{key:"deleteThis",value:function(e){for(var t=0;this._plans[t].number!==e;)++t;for(var a=this._plans[t].time,n=this._plans[t].timePeriod.length,i=0;i<n;++i)for(var r=this._plans[t].timePeriod[i][0],l=this._plans[t].timePeriod[i][1],o=r;o<l;++o)this._totalTimePerDay[o]-=a;this._plans.splice(t,1),this._plansHasChanged(),0===this._plans.length&&0===Va._plans.length&&en()}},{key:"_plansHasChanged",value:function(){Ha.printFromLogisticsPlan(this._plans),this.setStorage()}},{key:"chartGetPlans",value:function(){return this._plans}},{key:"rankingGetPlans",value:function(){return this._plans}}]),Na);function Na(){u(this,Na)}Ba._plans=[],Ba._plansNumber=0,Ba._startDate="",Ba._endDate="",Ba._totalDays=0,Ba._totalTimePerDay=[];var Ha=(e(Ga,null,[{key:"resize_Timetable",value:function(){var e=document.getElementById("PlanCombination_chart");null!==e.getAttribute("_echarts_instance_")&&document.getElementById("PlanCombinationSwitch").checked&&""!==e.getAttribute("_echarts_instance_")&&echarts.getInstanceByDom(e).resize()}},{key:"printFromLogisticsPlan",value:function(e){var t=Va.chartGetPlans();this.print(e,t)}},{key:"printFromConsumptionPlan",value:function(e){var t=Ba.chartGetPlans();this.print(t,e)}},{key:"print",value:function(e,t){var a=void 0;a=void 0===e?0:e.length;var n=void 0;n=void 0===t?0:t.length,0===a&&0===n?this._print_main():0===a&&0!==n?this._print_main(void 0,t):0!==a&&0===n?this._print_main(e):0!==a&&0!==n&&this._print_main(e,t)}},{key:"_print_main",value:function(e,t){var a=0<arguments.length&&void 0!==e?e:[{timePeriod:[0,0],time:0,number:-1,reAndco:[]}],n=1<arguments.length&&void 0!==t?t:[{timePeriod:[0,0],TimetableData:[0],number:-1,reAndco:[]}],i=document.getElementById("PlanCombination_chart"),r=void 0;null===i.getAttribute("_echarts_instance_")||""===i.getAttribute("_echarts_instance_")?r=echarts.init(i):((r=echarts.getInstanceByDom(i)).off("click"),r.clear());var l=ga(),o=Ta(),s=oa(l,o);this._LogisticsTimetableOriginalData=a,this._ConsumptionTimetableOriginalData=n,this._LogisticsTimetableData=this._LogisticsPlanDataToTimetableData(a,s),this._ConsumptionTimetableData=this._ConsumptionPlanDataToTimetableData(n,s);var d=xa(!0);this._reAndcoData=this._calcReAndCoData(d,a,n,s),this._reAndcoData=this._resourceRegen(s),this._reAndcoData=this._reAndcoDataToChartData(s);var u=function(n,e){for(var t=oa(n,e),a=new Array(t+1),i=0;i<t+1;++i)a[i]=la(n,i);var r=n.slice(0,4)===e.slice(0,4),l=(v.JS,!1),o=La(),s=rn(o),d=void 0;return d=-1!==o?[{yAxis:0},{yAxis:s},{yAxis:3e5}]:[{yAxis:0},{yAxis:3e5}],x()||(l=!0),{grid:[{left:60,right:45,top:50,height:125,tooltip:{trigger:"axis",axisPointer:{type:"line"}}},{left:60,right:45,bottom:55,height:70,tooltip:{type:"item"}}],tooltip:{trigger:"item",backgroundColor:"rgba(245, 245, 245, 0.8)",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#000"},position:function(e,t,a,n,i){var r={top:10};return r[["left","right"][+(e[0]<i.viewSize[0]/2)]]=30,r},formatter:function(e){for(var t="",a=0;a<8;++a)t+=e[a].marker+e[a].seriesName+": ",t+=e[a].data[1]+"<br>";return t},extraCssText:"width: 170px"},toolbox:{right:30,feature:{saveAsImage:{name:"GF",title:" "}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],minValueSpan:7,filterMode:"none"},{show:!0,xAxisIndex:[0,1],type:"slider",showDataShadow:!1,bottom:9,height:10,filterMode:"none",borderColor:"transparent",backgroundColor:"#e2e2e2",handleIcon:"M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",handleSize:16,handleStyle:{shadowBlur:6,shadowOffsetX:1,shadowOffsetY:2,shadowColor:"#aaa"},minValueSpan:7,labelFormatter:""}],legend:{left:0},xAxis:[{type:"value",min:0,max:t,axisTick:{show:!1},scale:!0,axisLabel:{show:!1},boundaryGap:!1,gridIndex:0,axisLine:{onZero:!1}},{type:"value",min:0,scale:!0,minInterval:1,axisLabel:{formatter:function(e){var t=la(n,e),a=t.slice(5);return r?a:a+"\n"+t.slice(0,4)}},max:t,gridIndex:1}],yAxis:[{name:v.JS.resource,nameGap:9,type:"value",scale:!0,gridIndex:0,splitLine:{show:!1},minInterval:1},{name:v.JS.contract,nameGap:9,type:"value",scale:!0,gridIndex:0,splitLine:{show:!1},minInterval:1},{max:1680,interval:1440,axisLine:{show:!0,step:1440},axisLabel:{show:!1},axisTick:{show:!1,alignWithLabel:!0},gridIndex:1}],series:[{name:v.JS.Manp,data:Ha._reAndcoData[0],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:v.JS.Ammu,data:Ha._reAndcoData[1],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:v.JS.Rati,data:Ha._reAndcoData[2],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:v.JS.Part,data:Ha._reAndcoData[3],type:"line",xAxisIndex:0,yAxisIndex:0,markLine:{silent:!0,label:{show:!1},data:d,symbol:"none",precision:0}},{name:v.JS.TPro,data:Ha._reAndcoData[4],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{name:v.JS.Equi,data:Ha._reAndcoData[5],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{name:v.JS.QPro,data:Ha._reAndcoData[6],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{name:v.JS.QRes,data:Ha._reAndcoData[7],type:"line",xAxisIndex:0,yAxisIndex:1,markLine:{silent:!0,label:{show:!1},data:{yAxis:0},symbol:"none",precision:0}},{type:"custom",renderItem:Ja,encode:{x:[0,1],y:2,itemName:3},data:Ha._LogisticsTimetableData,clip:!0,xAxisIndex:1,yAxisIndex:2,tooltip:{formatter:function(e){var t=e.dataIndex,a=v.JS.chartTooltip_L,n=Ha._LogisticsTimetableOriginalData[t].saved.Missions,i=["#A1C0FF","#FF8C8A","#75d874","#FFDA93"],r=a+"<br>";r+=v.JS.Mission+": <br>";for(var l=0;l<n.length;++l)r+="<span style='display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:"+i[l]+";'></span>",r+=n[l]+"<br>";return r}},emphasis:{itemStyle:{borderColor:"#000",borderWidth:1,borderType:"solid"}}},{type:"custom",renderItem:Oa,data:Ha._ConsumptionTimetableData,clip:!0,xAxisIndex:1,yAxisIndex:2,tooltip:{formatter:function(e){for(var t=e.dataIndex,a=v.JS.chartTooltip_C,n=Ha._ConsumptionTimetableOriginalData[t].reAndco,i=a+"<br>",r=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a"],l=["Manp","Ammu","Rati","Part","TPro","Equi","QPro","QRes"],o=0;o<8;++o)i+="<span style='display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:"+r[o]+";'></span>",i+=v.JS[l[o]],i+=": ",0<n[o]&&(i+="+"),i+=T(n[o])+"<br>";return i}},emphasis:{itemStyle:{borderColor:"#000",borderWidth:1,borderType:"solid"}}}],animation:l}}(l,o);r.setOption(u),r.on("click",{seriesIndex:8},function(e){Wa(e)}),r.on("click",{seriesIndex:9},function(e){Wa(e)}),$("#PC_deletePlan").off(),$("#PC_deletePlan").attr("disabled","true")}},{key:"_LogisticsPlanDataToTimetableData",value:function(e,t){var a=[],n=new Array(t);n.fill(0);for(var i=e.length,r=0;r<i;++r){var l={};l.name=e[r].number;var o=e[r],s=o.time;l.value=[s];for(var d=o.timePeriod.length,u=0;u<d;++u)for(var _=o.timePeriod[u][0],c=o.timePeriod[u][1],m=-1,h=_;h<c;++h){n[h]+=s;var v=n[h],g=l.value;if(v===m)g[g.length-1]++;else{var p=h;g.push(p),g.push(v),g.push(1),m=n[h]}}l.itemStyle={},l.itemStyle.color=this.colorList[r],a.push(l)}return a}},{key:"_ConsumptionPlanDataToTimetableData",value:function(e){for(var t=[],a=e.length,n=0;n<a;++n){var i={};i.name=e[n].number,i.value=e[n].TimetableData,i.itemStyle={},i.itemStyle.color=this.colorList[32+n],t.push(i)}return t}},{key:"_calcReAndCoData",value:function(e,t,a,n){for(var i=[],r=0;r<8;++r){var l=new Array(n);l.fill(0),l[0]=e[r];for(var o=t.length,s=0;s<o;++s)for(var d=t[s].reAndco[r],u=t[s].timePeriod.length,_=0;_<u;++_)for(var c=t[s].timePeriod[_][0],m=t[s].timePeriod[_][1],h=c;h<m;++h)l[h]+=d;for(var v=a.length,g=0;g<v;++g)for(var p=a[g].reAndco[r],b=a[g].timePeriod.length,T=0;T<b;++T)for(var f=a[g].timePeriod[T][0],y=a[g].timePeriod[T][1],P=f;P<y;++P)l[P]+=p;l[0]=r<4?Math.min(Math.round(l[0]),3e5):Math.round(l[0]);for(var C=1;C<n;++C){var S=Math.round(l[C]+l[C-1]);l[C]=!(r<4)||S<3e5?S:3e5}l.unshift(Math.round(e[r])),i.push(l)}return i}},{key:"_resourceRegen",value:function(e){var t=La(!0);if(-1===t)return this._reAndcoData;for(var a=rn(t),n=[1440,1440,1440,480],i=0;i<4;++i)for(var r=this._reAndcoData[i],l=0,o=1;o<=e;++o)if(r[o]+l<a){var s=l+n[i];r[o]+s>a&&(s=a-r[o]),r[o]+=s,l=s}else r[o]+=l;return this._reAndcoData}},{key:"_reAndcoDataToChartData",value:function(e){for(var t=[],a=0;a<8;++a){for(var n=[],i=this._reAndcoData[a],r=0;r<=e;++r)n.push([r,i[r]]);t.push(n)}return t}}]),Ga);function Ga(){u(this,Ga)}function Ja(e,t){for(var a=t.style(),n=[],i=t.value(0),r=e.dataIndex,l=Ha._LogisticsTimetableData[r].value,o=0;!isNaN(l[3*o+1]);){var s=t.coord([l[3*o+1],l[3*o+2]]),d=t.size([l[3*o+3],i]),u={type:"rect",shape:{}};u.shape.x=s[0],u.shape.y=s[1],u.shape.width=d[0],u.shape.height=d[1],u.style=a,n.push(u),++o}return{type:"group",children:n}}function Oa(e,t){for(var a=t.style(),n=[],i=t.value(0),r=e.dataIndex,l=Ha._ConsumptionTimetableData[r].value,o=0;!isNaN(l[3*o+1]);){var s=t.coord([l[3*o+1],l[3*o+2]]),d=t.size([l[3*o+3],i]),u={type:"rect",shape:{}};u.shape.x=s[0],u.shape.y=s[1],u.shape.width=d[0],u.shape.height=d[1],u.style=a,n.push(u),++o}return{type:"group",children:n}}function Wa(e){var t=e.seriesIndex,a=e.data.name;8===t?Ba.apply(a):Va.apply(a),$("#PC_deletePlan").removeAttr("disabled"),$("#PC_deletePlan").off(),$("#PC_deletePlan").on("click",function(){8===t?Ba.deleteThis(a):Va.deleteThis(a),$("#PC_deletePlan").attr("disabled","true")}),8===t&&it.cancelSelected();var n=document.getElementById("PlanCombination_chart");if(null!==n.getAttribute("_echarts_instance_")&&""!==n.getAttribute("_echarts_instance_")){var i=echarts.getInstanceByDom(n);i.dispatchAction({type:"downplay",seriesIndex:[8,9]}),i.dispatchAction({type:"highlight",seriesIndex:t,dataIndex:e.dataIndex})}}Ha.colorList=["#da0d68","#975e6d","#fde404","#0aa3b5","#9db2b7","#e0719c","#f99e1c","#4eb849","#ef5a78","#f7f1bd","#dd4c51","#3e0317","#6569b0","#c94a44","#f2684b","#aeb92c","#f68a5c","#baa635","#f7a128","#e2631e","#7eb138","#e1c315","#9ea718","#94a76f","#d0b24f","#b09733","#8f1c53","#b34039","#ba9232","#8b6439","#187a2f","#62aa3c","#038549","#28b44b","#7ac141","#5e9a80","#8b8c90","#beb276","#744e03","#a3a36f","#c9b583","#978847","#9d977f","#cc7b6a","#db646a","#76c0cb","#80a89d","#def2fd","#7a9bae","#039fb8","#5e777b","#caa465","#dfbd7e","#be8663","#899893","#a1743b","#894810","#c78936","#8c292c","#e5762e","#c78869","#d4ad12","#692a19"];function qa(){var e=Aa(!0);if(""+e!="0,0,0,0,0,0,0,0"){var t=new za(Ba.rankingGetPlans(),e);0!==t.allPlan.length?(t.ranking(),V.alert(v.JS.PC_ranking_done)):V.alert(v.JS.PC_ranking_add_alert)}else V.alert(v.JS.TargetValue0_alert)}var za=(e(Ua,[{key:"ranking",value:function(){for(var e=0,t=0;t<this.plans_number;++t){var a=this.allPlan[t],n=this.original_demandValue;a.ranking(n),e+=a.planValue}this.sortPlanByPlanValue();for(var i=this.original_demandValue.slice(),r=[0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0],o=0,s=0;s<this.plans_number;++s){var d=this.allPlan[s];o+=d.planValue,d.ranking(i);for(var u=0;u<8;++u)r[u]+=d.reAndcoValue_Norm[u],l[u]+=d.reAndcoValue[u]*d.days;for(var _=o/e,c=l[sa(r)]/_,m=0;m<8;++m)i[m]=this.original_demandValue[m]*c,i[m]-=l[m],i[m]<0&&(i[m]=0)}for(var h=this.original_demandValue.slice(),v=sa(r),g=l[v]/h[v],p=0;p<8;++p)0!==h[p]&&(h[p]=((h[p]*g-l[p])/l[p]*.9+1)*h[p]);i=this.original_demandValue.slice(),r=[0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0],e=o;for(var b=o=0;b<this.plans_number;++b){var T=this.allPlan[b];o+=T.planValue,0===b?T.ranking(h):T.ranking(i);for(var f=0;f<8;++f)r[f]+=T.reAndcoValue_Norm[f],l[f]+=T.reAndcoValue[f]*T.days;for(var y=o/e,P=l[sa(r)]/y,C=0;C<8;++C)i[C]=this.original_demandValue[C]*P,i[C]-=l[C],i[C]<0&&(i[C]=0)}for(var S=0;S<this.plans_number;++S)this.allPlan[S].applyToLogisticsPlanData();Ba._plansHasChanged()}},{key:"sortPlanByPlanValue",value:function(){this.allPlan.sort(ja)}}]),Ua);function Ua(e,t){u(this,Ua),this.original_demandValue=t,this.allPlan=[];var a=e.length;this.plans_number=a;for(var n=[0,0,0,0,0,0,0,0],i=0;i<a;++i){this.allPlan.push(new Ya(e[i],t));for(var r=this.allPlan[i].reAndcoValue_Max,l=0;l<8;++l)n[l]=Math.max(n[l],r[l])}this.reAndcoValue_MaxMax=n;for(var o=0;o<a;++o)this.allPlan[o].resetReAndCoValueMax(this.reAndcoValue_MaxMax.slice())}function ja(e,t){return t.planValue-e.planValue}var Ya=(e(Xa,[{key:"calcDays",value:function(){for(var e=this.LogisticsPlanData.timePeriod,t=0,a=0;a<e.length;++a)t=t+e[a][1]-e[a][0];return t}},{key:"resetReAndCoValueMax",value:function(e){this.reAndcoValue_Max=e}},{key:"ranking",value:function(e){var t=it.creatTabBySaved(this.LogisticsPlanData.saved);t.setQValid();var a=new Zt(t,8,48,38,e);a.ranking();for(var n=a.getStdznTargetValue("PlanCombination"),i=new Array(8),r=t.getCurrentValueMax(),l=0;l<8;l++)i[l]=Math.min(1,n[l]/r[l]),i[l]=Math.max(i[l],0);t.normalizedQValid();var o=new ea(t,3,i);o.ranking();var s=o.getResult(),d=[];if(0!==s.length){for(var u=this.totalTime,_=0;_<8;++_)d.push(s[0][_+5]*u);this.missions=s[0].slice(1,5)}else d=[0,0,0,0,0,0,0,0],this.missions=[];this.reAndcoValue=d,this.reAndcoValue_Norm=this.normReAndCo(this.reAndcoValue),this.planValue=this.calcPlanValue(this.reAndcoValue_Norm)}},{key:"normReAndCo",value:function(e){for(var t=this.reAndcoValue_Max,a=[],n=this.days,i=0;i<8;++i)a.push(n*e[i]/t[i]);return a}},{key:"calcPlanValue",value:function(e){for(var t=0,a=0;a<8;++a)t+=e[a];return t}},{key:"applyToLogisticsPlanData",value:function(){this.LogisticsPlanData.saved.Missions=this.missions,this.LogisticsPlanData.reAndco=this.reAndcoValue}}]),Xa);function Xa(e,t){u(this,Xa),this.LogisticsPlanData=e;var a=it.creatTabBySaved(e.saved);this.totalTime=a.getTotalTime(),a.setQValid(),this.reAndcoValue_Max=a.getCurrentValueMax(),this.original_demandValue=t,this.days=this.calcDays()}function Za(){document.getElementById("PlanCombinationSwitch").checked?(Pe(),it.cancelSelected(),nt(),at(),$("#plan_combination_card").removeClass("d-none"),$("#PlanCombination_addTimePeriod").removeClass("d-none"),$("#PC_addLogisticsPlan").removeClass("d-none"),$("#target").addClass("d-none"),$("#start_ranking").addClass("d-none"),$("#result_card").addClass("d-none"),$("#Logistics_setting_title").removeClass("d-none")):(an(),$("#plan_combination_card").addClass("d-none"),$("#PlanCombination_addTimePeriod").addClass("d-none"),$("#PC_addLogisticsPlan").addClass("d-none"),$("#PC_addConsumptionPlan").addClass("d-none"),$("#target").removeClass("d-none"),$("#start_ranking").removeClass("d-none"),$("#result_card").removeClass("d-none"),$("#Logistics_setting_title").addClass("d-none")),Ha.resize_Timetable()}function Ka(){$("#PlanCombination_startDate").attr("disabled","true"),$("#PlanCombination_endDate").attr("disabled","true")}function en(){$("#PlanCombination_startDate").removeAttr("disabled"),$("#PlanCombination_endDate").removeAttr("disabled")}function tn(){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!0,$("#ConsumptionPlan_setting").removeClass("d-none"),$("#PC_addLogisticsPlan").addClass("d-none"),$("#PC_addConsumptionPlan").removeClass("d-none"),$("#plan_setting").addClass("d-none")}function an(){document.getElementById("LogisticsConsumptionPlanSwitch").checked=!1,$("#ConsumptionPlan_setting").addClass("d-none"),$("#PC_addLogisticsPlan").removeClass("d-none"),$("#PC_addConsumptionPlan").addClass("d-none"),$("#plan_setting").removeClass("d-none")}var nn=[0,3e3,3200,3400,3600,3800,4e3,4200,4500,4700,5e3,5200,5500,5700,6e3,6300,6600,6900,7200,7500,7800,8100,8400,8700,9100,9400,9700,10100,10400,10800,11200,11500,11900,12300,12700,13100,13500,13900,14300,14700,15100,15500,16e3,16400,16900,17300,17800,18200,18700,19200,19600,20100,20600,21100,21600,22100,22600,23100,23600,24200,24700,25200,25800,26300,26900,27400,28e3,28600,29100,29700,30300,30900,31500,32100,32700,33300,33900,34600,35200,35800,36500,37100,37800,38400,39100,39700,40400,41100,41800,42500,43200,43900,44600,45300,46e3,46700,47400,48200,48900,49600,50400,51100,51900,52600,53400,54200,55e3,55700,56500,57300,58100,58900,59700,60600,61400,62200,63e3,63900,64700,65500,66400,67300,68100,69e3,69800,70700,71600,72500,73400,74300,75200,76100,77e3,77900,78800,79800,80700,81600,82600,83500,84500,85400,86400,87400,88400,89300,90300,91300,92300,93300,94300,95300,96300,97400,98400,99400,1e5];function rn(e){return 156<e?1e5+200*(e-156):nn[e]}function ln(e){if("LocalStorage"===e){var t=_a("Date");"noStorage"===t?(pa((new Date).toISOString().slice(0,10)),fa(la((new Date).toISOString().slice(0,10),7))):(pa(t.start),fa(t.end));var a=_a("current");"noStorage"!==a&&Da(a);var n=_a("target");"noStorage"!==n&&Ia(n);var i=_a("demand");"noStorage"!==i&&Ma(i);var r=_a("level");"noStorage"!==r&&Ra(r),Ba.init(_a("LogisticsPlan")),Va.init(_a("ConsumptionPlan"))}else{var l=e.date;pa(l.start),fa(l.end),Da(e.current),Ia(e.target),Ma(e.demand),Ra(e.level),Ba.init(e.LogisticsData),Va.init(e.ConsumptionData)}ba(),ya(),Ca(),ka(),Ha.print(Ba.chartGetPlans(),Va.chartGetPlans())}$("#PlanCombinationSwitch").on("click",function(){Za()});var on=$("#PlanCombination_startDate");on.on("input propertychange",function(){ya(),Ca(),ka(),Ea.clear()}),on.on("blur",function(){ua("Date",{start:ga(!0),end:Ta()}),Ba.reset(),Va.reset(),Ha.print()});var sn=$("#PlanCombination_endDate");function dn(){E(),$("#PC_ranking_loading").addClass("d-none")}function un(){window.sha1&&window.md5&&window.LZString&&window.echarts&&window.ES6Promise&&window.html2canvas?($("#Config_importInput").removeAttr("disabled"),$("#Config_importButton").removeAttr("disabled"),$("#Config_export").removeAttr("disabled"),$("#importSaved_input").removeAttr("disabled"),$("#importSaved_importButton").removeAttr("disabled"),$("#Capture").removeAttr("disabled"),$("#page_loading").remove(),$("#PlanCombinationSwitch").removeAttr("disabled"),ln("LocalStorage"),Ee=!0):setTimeout(un,100)}function _n(){if(!window.sha1){var e=document.createElement("script");e.src="./dependent/js/sha1.min.js",document.body.appendChild(e)}if(!window.md5){var t=document.createElement("script");t.src="./dependent/js/md5.min.js",document.body.appendChild(t)}if(!window.LZString){var a=document.createElement("script");a.src="./dependent/js/lz-string.min.js",document.body.appendChild(a)}if(!window.echarts){var n=document.createElement("script");n.src="./dependent/js/echarts.min.js",document.body.appendChild(n)}if(!window.ES6Promise){var i=document.createElement("script");i.src="./dependent/js/es6_promise.auto.min.js",document.body.appendChild(i)}if(!window.html2canvas){var r=document.createElement("script");r.src="./dependent/js/html2canvas.min.js",document.body.appendChild(r)}}sn.on("input propertychange",function(){ba(),Ca(),ka(),Ea.clear()}),sn.on("blur",function(){var e=Ta(!0);ua("Date",{start:ga(),end:e}),Ba.reset(),Va.reset(),Ha.print()}),$("#CommanderLevel").on("blur",function(){ua("level",La()),Ha.print(Ba.chartGetPlans(),Va.chartGetPlans())}),$("#PlanCombination_planStartDate").on("blur",function(){Pa(!0),ka()}),$("#PlanCombination_planEndDate").on("blur",function(){Sa(!0),Ca()}),$("#PC_deleteAllPlans").on("click",function(){V.confirm(v.JS.PC_deleteAll_confirm,function(){Ba.deleteAll(),Va.deleteAll()})}),$("#LogisticsConsumptionPlanSwitch").on("click",function(){(document.getElementById("LogisticsConsumptionPlanSwitch").checked?tn:an)()}),$("#addNewTimePeriod").on("click",function(){Ea.add()}),$("#deleteAllTimePeriod").on("click",function(){Ea.clear()}),$("#PC_DateTimePeriod_body").on("click","button[id^=PC_TimePeriod_close_]",function(){var e="PC_TimePeriod_"+b(this.id);Ea.deleteThisRow(e)}),$("#PC_addLogisticsPlan").on("click",function(){Ba.add()}),$("#PC_addConsumptionPlan").on("click",function(){Va.add()}),$("#Consumption_add").on("click",function(){Va.table_add()}),$("#Consumption_reset").on("click",function(){$("#Consumption_select").val(0),wa(),function(e){var t=0<arguments.length&&void 0!==e?e:"1";$("#Consumption_times").val(t)}()}),$("#Consumption_tbody").on("click","button[id^=Consumption_table_close_row_]",function(){var e="Consumption_table_row_"+b(this.id);Va._table_deleteThisRow(e)}),$("#PC_startRanking").on("click",function(){R(),$("#PC_ranking_loading").removeClass("d-none"),setTimeout(qa,1),setTimeout(dn,1)}),$("#PlanCombination_current_box").on("blur","input[id^=PC_current_]",function(){Ha.print(Ba.chartGetPlans(),Va.chartGetPlans()),ua("current",xa())}),$("#PlanCombination_current_box").on("focus","input[id^=PC_current_]",function(){this.select()}),$("#PlanCombination_demand_card").on("blur","input[id^=PC_target_]",function(){ua("target",$a())}),$("#PlanCombination_demand_card").on("focus","input[id^=PC_target_]",function(){this.select()}),$("#PlanCombination_demand_card").on("blur","input[id^=PC_demand_]",function(){ua("demand",Aa())}),$("#PlanCombination_demand_card").on("focus","input[id^=PC_demand_]",function(){this.select()}),$("#PC_calcDemand").on("click",function(){!function(){for(var e=xa(!0),t=oa(ga(),Ta()),a=Ha._calcReAndCoData(e,[],Va.chartGetPlans(),t),n=[],i=a[0].length-1,r=$a(!0),l=0;l<8;++l){var o=a[l][i];o=Math.max(0,r[l]-o),n.push(o)}Ma(n)}()}),$("#PC_saveAll").on("click",function(){V.confirm(v.JS.PC_saveAll_confirm,function(){!function(){for(var e=Ba._plans.length,t=0;t<e;++t)it._saved.push(Ba._plans[t].saved),it._printLastSaved()}()})}),$("#Consumption_select").on("change",function(){wa(Qe[this.selectedIndex-1])}),$("input[id^=Consumption_]").on("focus",function(){this.select()}),window.onload=function(){$("#Notransition").remove();var e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/js-sha1@0.6.0/src/sha1.min.js",document.body.appendChild(e);var t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js",document.body.appendChild(t);var a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js",a.integrity="sha256-nRoO8HoupfqozUr7YKBRgHXmdx40Hl/04OSBzv7e7L8=",a.crossOrigin="anonymous",document.body.appendChild(a);var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/echarts@4.6.0/dist/echarts.min.js",n.integrity="sha256-9TvhGliyfFW2O8SvloAhdFQbfjluHQ+vQ7WWWX5Z7oM=",n.crossOrigin="anonymous",document.body.appendChild(n);var i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/es6-promise@4.2.8/dist/es6-promise.auto.min.js",i.integrity="sha256-Xxrdry6fWSKu1j2ALyuK/gHFQ+2Bp76ZrR6f3QXI47Y=",i.crossOrigin="anonymous",document.body.appendChild(i);var r=document.createElement("script");r.src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.1/dist/html2canvas.min.js",r.integrity="sha256-uacRffSSMP9qpvNWhVmYLykBv9YKMA1d/VSIN1AmfyQ=",r.crossOrigin="anonymous",document.body.appendChild(r),un(),setTimeout(_n,6e3)},$("#start_ranking").removeAttr("disabled");